---
title: "Case Illustration: Large-N Method"
subtitle: "Understanding Policies (10700193-90)"
author: "Yue Hu"
institute: "Tsinghua University" 
knitr: 
    opts_chunk:
      echo: false
format: 
  revealjs:
    css: https://www.drhuyue.site/slides_gh/css/style_basic.css
    theme: ../../../css/goldenBlack.scss
    slide-number: true
    # filters: [appExclusion.lua] # not count appendices into page number
    incremental: true
    preview-links: true # open an iframe for a link
    link-external-newwindow: true
    self-contained: false
    chalkboard: false # allwoing chalk board B, notes canvas C
    # callout-icon: false
    show-slide-number: all # `speaker` only print in pdf, `all` shows all the time
    title-slide-attributes:
      data-background-image: https://gitlab.com/sammo3182/backup/raw/85b3c1ad4b459d7a9f901f124b936428eda5fcaf/logo_THPS.png?inline=true
      data-background-size: 250px   
      data-background-position: top 10% right 5%
    default-image-extension: png
revealjs-plugins:
  - spotlight
lightbox: 
  match: auto
  effect: fade
spotlight:
  size: 50
  presentingCursor: default
  toggleSpotlightOnMouseDown: false
  spotlightOnKeyPressAndHold: 73 # keycode for "i"
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
if (!require(pacman)) install.packages("pacman")
library(pacman)

p_load(
  icons
) # data wrangling # data wrangling

# Functions preload
set.seed(313)
```

## Overview

:::: {.columns}

::: {.column width="50%"}
+ What is a large-N analysis (LNA)
  + How large is large?
- Why doing LNA
  - Why NOT experiment
  - What do we look for from the LNA?
:::

::: {.column width="50%"}
+ How
    + One
    + Two
    + More than two

![](https://drhuyue.site:10002/sammo3182/figure/lar_econometrics.jpg){fig-align="center" height=300}

:::

::::


# What

## What's LNA

In lieu of "quantitative"...

:::{.notes}
What's a å®šé‡ç ”ç©¶?

- å®šç»“æœçš„é‡
- å®šæ•°æ®çš„é‡
  - éƒ½æ˜¯é‡å—ï¼Ÿbinaryï¼Œcategoricalï¼Œ ordinary

Did you really å®šé‡ï¼Ÿ
:::

--

Large-.red[N]: Number of **observations**---not subjects, not trails

- How large? 10, 100, 1000, 10000?
    - > We don't know......   
    - > It depends......  
    - > The larger, the better!

???

How about experiment

--

.center[To know what, you need to know WHY]

---

class: inverse, bottom

# Why

---

## Why Not Experiments?

.pull-left[
### Experiment is powerful!

+ Excluding confounders
+ Clear outcomes
+ Clear causal chain
]
--

.pull-right[
### However,

1. .red[Not always] practical
1. .red[Difficult] to collect observed data
1. "Not-cool" methods
]

.bg-black.golden.ba.shadow-5.ph4.mt3[
.center[
Goal*

Quasi-experiment
]
]

.footnote[\* *Collins Thesaurus*: Quasi- =  pseudo-, apparent, seeming, semi-, so-called, would-be]

---

## Why Have to Be LARGE-N

What are we looking for?

???

A representative number of a lot of numbers

--

Statistically, 


.bg-black.golden.ba.shadow-5.ph4.mt3[

.center[*Law of Large Numbers*(LLN)]

As the number of experiments (sample) increases, the ratio of outcomes will converge to the theoretical (population) average.
]


???

Using sample to estimate population

---

## Then How Large

LLN gives a rule of thumb: 100

--

.center[Is LLN enough? ]

--

.bg-black.golden.ba.shadow-5.ph4.mt3[

.center[*Central Limit Theorem*(CLT)]

The sampling distribution of the sample means approaches a normal distribution as the sample size gets larger.
]

???

Why using normal distribution

---

## Let's Feel It

.pull-left[
My highly-educated fellows, let's play a .blue[happy-happy] kid game!

And we are going outside! ğŸ˜ˆ

]

.pull-right[
### Step 1: Toss a fair coin

+ Head: 1 step to the .blue[&larr;]
+ Tail: 1 step to the .red[&rarr;]

### Step 2: Toss six times

### Step 3: Going forward
]

---

<video width="1000" height="600" controls preload>
    <source src="https://link.jscdn.cn/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3YvcyFBcnR0dk83MHdLSU8xR3lVRGoxaEpFODFDVkN0P2U9SWJHUWRY.mp4" type="video/mp4">
</video>

---

## How Large Is Large?

.center[LLN says 100. CLT ?]

.center[<img src="images/lar_largeNumber.gif" />]

--

.center[Should we always get 10,000?]

.pull-left[
$\text{Margin of Error} = Z \times \frac{S}{\sqrt n}.$
]
.pull-right[
| Sample Size (n) | Margin of Error (M.E.) |
|-----------------|------------------------|
| 200             | 7.1%                   |
| 1000            | 3.2%                   |
| 2000            | 2.2%                   |
| 4000            | 1.6%                   |
]

???

To cut the margin of error in half, like from 3.2% down to 1.6%, you need four times as big of a sample, like going from 1000 to 4000 respondents. To cut the margin of error by a factor of five, you need 25 times as big of a sample

---

class: inverse, bottom

# How

---

## Univariate analysis

.pull-left[
.center[<img src="images/lar_tooManyCourses.jpg" />]
]

.pull-right[
```{r data}
showWatching <- tibble(Student_ID = paste0("202309", sample(1000:9000, size = 7)), Courses = c(9, 9, 12, 10, 8, 10, 15))

kable(showWatching, "html", align = "cl")%>%
  kable_styling(full_width = TRUE, font_size = 25)
```
]

???

Let's say we'll test a school policy of course management

---

## How to Represent Variable

Given the courses students took: (9, 9, 12, 10, 8, 10, 15)
--

.pull-left[

+ Mean: $\frac{9 + 9 + 12 + 10 + 8 + 10 + 15}{7} \approx 11.$
+ Median: 8, 9, 9, .red[10], 10, 12, 15
+ Mode: 8, .red[9], .red[9], .red[10], .red[10], 12, 15

Which one is better?

]

--

.pull-right[
How about this data?

<img src="../analysisOfPoliticalData/images/desc_sheHulk.png" height = 400 />

]

---

## Descriptive Statistics

- Number (mean, usually)
- Statistics
- Plot (.red[**&check;**])

```{r descriptive}
df_descrptive <- select(mtcars, -am, -carb) %>% 
  mutate(across(where(~length(unique(.x)) == 2), as.logical),
         across(where(~length(unique(.x)) < 7 & !is.logical(.x)), as.factor))

datasummary_skim(df_descrptive, histogram = FALSE)
```

---

## Binary Analysis

.pull-left[

Relations between variables

```{r scatter, fig.align='center'}
ggplot(mtcars, aes(wt, mpg)) +
  geom_point() +
  ylab("Mileage per Gallon") +
  xlab("Weight")
```
]

--

.pull-right[

How about...

```{r scatterMess, fig.align='center'}
data(tobacco, package = "summarytools")

ggplot(tobacco, aes(age, cigs.per.day)) +
  geom_point() +
  ylab("Cigrate per day") +
  xlab("Age")
```
]

---

## Multivariate Analysis

.center[<img src="../analysisOfPublicPolicy/images/lar_buyerSeller.jpg" height = 250 />]

.pull-left[
<img src="../analysisOfPublicPolicy/images/lar_matching.png" height = 250 />
]

.pull-right[
.center[<img src="../analysisOfPublicPolicy/images/lar_fitOLS.png" height = 250 />]
]

---

## Controls May Not Work

<video width="1000" height="500" controls preload>
    <source src="https://link.jscdn.cn/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3YvcyFBcnR0dk83MHdLSU8ybkpQMndTTjZ2MGRiUjFnP2U9bXBIV1NK.mp4" type="video/mp4">
</video>

---

class: middle

.bg-dark-red.golden.ba.shadow-5.ph4.mt3[

ä»»ä½•æ”¿ç­–éƒ½å»ºç«‹åœ¨å¯¹äº‹ç‰©å·®å¼‚æ€§çš„åˆ†æå’ŒæŠŠæ¡ä¹‹ä¸Šï¼Œ**æ²¡æœ‰å·®å¼‚æ€§å°±æ²¡æœ‰æ”¿ç­–**ã€‚æˆ‘å›½ç¤¾ä¼šå·®å¼‚æ€§ç‰¹å¾æ˜æ˜¾ï¼Œåæ˜ åœ¨åœ°åŸŸã€åŸä¹¡ã€æ°‘æ—ã€äººç¾¤ç­‰å¤šä¸ªå±‚é¢ã€‚æˆ‘ä»¬çš„å†³ç­–éƒ¨ç½²æœ‰ç»¼åˆæ€§çš„ï¼Œä¹Ÿæœ‰ä¸“é¡¹æ€§çš„â€¦â€¦è¿™äº›éƒ½éœ€è¦å……åˆ†ç†Ÿæ‚‰æƒ…å†µã€æ·±å…¥åˆ†æè®ºè¯ã€ç§‘å­¦æŠŠæ¡å°ºåº¦ã€‚è¦åšæŒç§‘å­¦å†³ç­–ã€æ°‘ä¸»å†³ç­–ã€ä¾æ³•å†³ç­–ï¼Œå¯¹æƒ…å†µè¿›è¡Œæ·±å…¥åˆ†æã€‚

.tr[
--- ä¹ è¿‘å¹³ (ã€Šä¸­å¤®æ”¿æ²»å±€çš„åŒå¿—å¿…é¡»æœ‰å¾ˆå¼ºçš„çœ‹é½æ„è¯†ã€‹, 2015å¹´12æœˆ)
]
]

---

## In Practice

.pull-left[<img src="images/table.png" height = 550 />]

.pull-right[
+ Coefficients

+ Uncertainty

+ Significance

+ Goodness of fit


]

---

## Take-Home Points

.pull-left[
+ What: "Quantitative" analysis
  + How large is large?
    + LLN: 100
    + CLT: 1000
- Why
  - Why Not experiment?
  - What do we look for from the LNA?
    - Average and distribution
+ How 
    + Univariate
    + Bivariate
    + Multivariate
]

--

.pull-right[
### Bonus: Wonder how to conduct large-N analysis?

Ta-da~~~

.large[.green["æ²»ç†æŠ€æœ¯ä¸“é¢˜ï¼šæ”¿æ²»æ•°æ®åˆ†æ" (70700173)] ğŸ˜‹]
]

```{r pdfPrinting, eval = FALSE, include = FALSE}
pagedown::chrome_print(list.files(pattern = "10_.*.html"), timeout = 300)
```