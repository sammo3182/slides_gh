---
title: "æ½œå˜é‡åˆ†æï¼ˆè¿›é˜¶ï¼‰"
subtitle: "æ”¿åŠ¡å¤§æ•°æ®åº”ç”¨ä¸åˆ†æ (80700673)"
author: "èƒ¡æ‚¦"
institute: "æ¸…åå¤§å­¦ç¤¾ä¼šç§‘å­¦å­¦é™¢" 
bibliography: t_politicalData.bib

format: 
  revealjs:
    css: https://www.drhuyue.site/slides_gh/css/style_basic.css
    theme: ../../../css/goldenBlack.scss
    number-sections: true
    slide-number: true
    filters: [appExclusion.lua] # not count appendices into page number
    incremental: false
    preview-links: true # open an iframe for a link
    link-external-newwindow: true
    self-contained: false
    chalkboard: false # allwoing chalk board B, notes canvas C
    # callout-icon: false
    show-slide-number: all # `speaker` only print in pdf, `all` shows all the time
    show-notes: false
    title-slide-attributes:
      data-background-image: https://gitlab.com/sammo3182/backup/raw/85b3c1ad4b459d7a9f901f124b936428eda5fcaf/logo_THPS.png?inline=true
      data-background-size: 250px   
      data-background-position: top 10% right 5%
    default-image-extension: png
revealjs-plugins:
  - spotlight
lightbox: 
  match: auto
  effect: fade
spotlight:
  size: 50
  presentingCursor: default
  toggleSpotlightOnMouseDown: false
  spotlightOnKeyPressAndHold: 73 # keycode for "i"

execute: 
  echo: false
editor_options: 
  chunk_output_type: console
editor: 
  render-on-save: true
---

```{r setup}
#| label: setup
#| include: false

library(pacman)

p_load(
  ltm,
  mirt,
  TeachingSampling,
  lme4,
  ggalt,
  DCPO,
  latex2exp,
  knitr,
  kableExtra,
  drhutools,
  here,
  tidyverse
)

# Functions preload
set.seed(313)

theme_set(
  theme_minimal(base_size = 18)
)

theme_update(
  plot.title = element_text(size = 18),
  axis.title = element_text(size = 22),
  axis.text = element_text(size = 18)
)
```


## æ¦‚è¦ {.unnumbered}

:::{style="text-align:center"}
**å¾…è§£ä¹‹é¢˜**

è§‚æµ‹å˜é‡ä¸æ½œå˜é‡ä¹‹é—´å…³ç³»è¦[éçº¿æ€§]{.red}
:::

:::: {.columns}

::: {.column .fragment .nonincremental width="50%"}
*æ–¹æ³•*

1. é¡¹ç›®ååº”ç†è®º(IRT)
1. é¡¹ç›®ååº”èšåˆä¼°è®¡
:::

::: {.column .fragment .nonincremental width="50%"}
*æ“ä½œè¯­è¨€*

* R^[ç°å­˜å¤„ç†IRTçš„R packageså·²è¶…è¿‡[50](https://www.tandfonline.com/doi/full/10.1080/15366367.2019.1586404?src=recsys)ä¸ªã€‚]
    + [`mirt`](https://github.com/philchalmers/mirt/wiki)
    + [`DCPO`](https://github.com/fsolt/DCPO)
:::

::::

# é¡¹ç›®ååº”ç†è®º

## è¶…è¶Šå› å­åˆ†æ
**å› å­åˆ†æå¼Šç«¯**ï¼š

:::: {.columns}

::: {.column width="50%"}
1. å‡å®šæ½œåœ¨å˜é‡æ˜¯[è¿ç»­]{.red}çš„ï¼›
1. å¯¹äºæŒ‡æ ‡[ä¸åŒºåˆ†]{.red}å˜é‡ç±»å‹ï¼›
1. éš¾ä»¥æ•æ‰[ç¾¤ç»„]{.red}å·®å¼‚
:::

::: {.column width="50%"}
4. EFAæ— æ³•å›Šæ‹¬[æŒ‡æ ‡é—´]{.red}å…³ç³»;
5. CFAâ€œ[ç®€ç•¥]{.red}ç†è®ºvsæµ‹é‡è´¨é‡â€çŸ›ç›¾
:::

::::

:::{.fragment style="text-align:center"}
&dArr;

![ç¦»æ•£å›åº”æ¨¡å‹](https://drhuyue.site:10002/sammo3182/figure/lv_irt.webp){fig-align="center" height=300}
:::

:::{.notes}
CFAç†è®ºé€šå¸¸ç®€ç•¥ï¼Œåªæ¶‰åŠä¸€éƒ¨åˆ†indicesï¼Œä½†å®é™…å¯èƒ½å¾ˆå¤æ‚ï¼›å½“å›Šæ‹¬æ›´å¤šindicesæµ‹é‡è´¨é‡ä¼šé«˜ï¼Œä½†ä¸ç¬¦åˆç†è®ºã€‚
:::


## ç±»å‹åˆ†æ

![åŸºäºå•ä¸€æ½œåœ¨å˜é‡åˆ’åˆ†â€œä¸‰å…­ä¹ç­‰" (Queen's Gambit)](https://drhuyue.site:10002/sammo3182/figure/lv_game.jpg){fig-align="center" height=200}

:::: {.columns}

::: {.column .fragment width="50%"}
![Frederic M. Lord](https://drhuyue.site:10002/sammo3182/figure/lv_lord.png){fig-align="center" height=300}
:::

::: {.column .fragment width="50%"}
*Item Response Theory *(IRT)

1. å¤©ç”Ÿä¸º[äºŒå…ƒ]{.navy}æŒ‡æ ‡è®¾è®¡ï¼ˆè¡ç”Ÿé€‚åº”å®šåºå˜é‡å’Œè¿ç»­å˜é‡ï¼‰ï¼›
1. æ˜“ä¸Bayesian inferenceç»“åˆï¼Œè§£å†³[æ½œåœ¨å˜é‡scale]{.navy}ä¸ç¡®å®šé—®é¢˜ï¼›
1. æ˜“ä¸è·¨ç¾¤ç»„ä¼°è®¡ç»“åˆï¼Œå®ç°æŒ‡æ ‡[è·¨ç»„å¯æ¯”]{.navy}
:::

::::

:::{.notes}
Frederic M. Lord, psychometrician, first worked for the Carnegie Foundation in 1944. By 1950, he began working for the Educational Testing Service (ETS). 
Lord's research shaped the SAT, GRE, GMAT, LSAT and the TOEFL. 
Lord was called the "Father of Modern Testing" by the National Council on Measurement in Education.
:::

## Basic IRT

:::: {.columns}

::: {.column width="60%"}
- è°ƒæŸ¥å±‚æ¬¡ï¼šä¸ªä½“
- Item: "ä¸€é“é¢˜"
- Response: "å¯¹ä¸€é“é¢˜ï¼ˆçš„é€‰é¡¹ï¼‰"
- æŒ‡æ ‡ç§ç±»
    1. Yes/No
    2. å¯ä»¥è½¬åŒ–ä¸ºäºŒå…ƒçš„é—®é¢˜
    3. å®šåºé—®é¢˜ï¼ˆe.g., Liker scale questionsï¼‰
:::

::: {.column .fragment width="40%"}
[**Assumptions**]{.red}

1. Monotonicity
1. Unidimensionality
1. Local independence
1. Parameter invariance

:::

::::

## Monotonicity

![Item characteristic curve, éšæ½œåœ¨å˜é‡å¢åŠ ï¼Œè·å¾—1çš„å¯èƒ½æ€§ä¹Ÿéšä¹‹å¢åŠ ](https://drhuyue.site:10002/sammo3182/figure/irt_icc.png){fig-align="center" height=500}


:::{.notes}
éšç€èƒ½åŠ›çš„æé«˜ï¼Œå›ç­”æ­£ç¡®ç­”æ¡ˆçš„æœºä¼šä¹Ÿå°±è¶Šé«˜
:::


## Unidimensionality

:::: {.columns}

::: {.column width="50%"}
+ èšåˆçš„é¡¹ç›®å‡æŒ‡å‘åŒä¸€ä¸ªæ½œåœ¨å˜é‡^[ç›´åˆ°å¼•å…¥multidimensional IRT]
+ åŸºäºç†è®º
:::

::: {.column .fragment width="50%"}
![](https://drhuyue.site:10002/sammo3182/figure/lv_angry.jpg){fig-align="center" height=500}
:::

::::

## Local Independence

::::{.columns}

::: {.column width="60%"}

:::{style="text-align:center"}
$P(Y_{ip}, Y_{iq}|\theta_i) = P(Y_{ip}|\theta_i)P(Y_{iq}|\theta_i),$

- p, q: Items
- i: Respondent
- Y<sub>ip</sub>: iå¯¹äºé¡¹ç›®pçš„çš„ååº”
- &theta;<sub>i</sub>: ååº”è€…içš„æ½œåœ¨å˜é‡
:::

:::{.fragment}
å¯¹äºä¸åŒé¡¹ç›®çš„ååº”ä¹‹é—´ï¼Œå…³è”æ€§[åª]{.red}æ¥è‡ªå…±åŒçš„æ½œåœ¨å˜é‡ã€‚
:::

:::

::: {.column .fragment width="40%"}
![](https://drhuyue.site:10002/sammo3182/figure/lv_musk.png){fig-align="center" height=600}
:::

::::



:::{.notes}
æ¢è¨€ä¹‹ï¼Œæ§åˆ¶æ½œåœ¨å˜é‡å½±å“åï¼Œé—®é¢˜é—´å“åº”ç›¸äº’ç‹¬ç«‹
:::



## Parameter Invariance

![](https://drhuyue.site:10002/sammo3182/figure/lv_gre.jpg){fig-align="center" height=350}

- é¡¹ç›®ç‰¹ç‚¹ï¼ˆparameters of itemsï¼Œæ¯”å¦‚éš¾åº¦ã€æ¢¯åº¦ç­‰ï¼‰åœ¨[é¡¹ç›®é—´]{.red}ä¸å˜
- é¡¹ç›®ç‰¹ç‚¹åœ¨[å“åº”äººç¾¤é—´]{.red}ä¸å˜^[é€šè¿‡åŸºäºWald and likelihood-ratio approachæ¥æ£€æµ‹Differential item functioning (DIF).]

::: {.callout-warning .fragment}
## When parameters vary

å½“è¿›è¡ŒMultiple Group IRTæ—¶å°¤å…¶å®¹æ˜“è¢«è¿å!
:::

::: {.notes}
ä¸æƒ³è¢«è¿åçš„åŠæ³•ï¼šè¶³å¤Ÿå¤šçš„å‚æ•°ï¼›GPT 3.5 175B parametersï¼› 4ï¼Œ 1.8Tï¼› deepseek R1 671 b
:::


## IRTæ¨¡å‹å‘å±•

:::: {.columns}

::: {.column width="30%"}
Rasch Model (1PL)  

:::{.notes}
Rasch /resh/
:::
:::

::: {.column .fragment width="70%"}
&rarr; Two-Parameter Logistic Model (2PL)     
&rarr; Three-Parameter Logistic Model (3PL)     
&rarr; Four-Parameter Logistic Model (4PL)
:::

::::

:::{.fragment style="text-align:center; margin-top: 2em"}
&darr;

Multidimensional IRT        
Ordinal IRT       
Group IRT       
:::


## Rasch Model

+ y<sub>iq</sub>&isin;{0,1}: ååº”ï¼Œ`i`å¯¹é—®é¢˜`q`çš„å›ç­”
+ &theta;<sub>i</sub>&isin;{-&infin;, +&infin;}: ååº”èƒ½åŠ›ï¼Œ(Unbounded latent trait)
+ &sigma;<sub>q</sub>: Difficultyï¼Œé—®é¢˜éš¾æ˜“ç¨‹åº¦ï¼Œé€šå¸¸æ˜¾ç¤ºä¸ºz scores

:::{.fragment .nonincremental}
ğŸŒ° ä¸åŒéš¾åº¦çš„é¡¹ç›®ï¼š
    
+ å½“é¢ä¸´é‡å¤§å…¬å…±å«ç”Ÿå¨èƒæ—¶ï¼Œæ”¿åºœæ˜¯å¦åº”è¯¥åŠæ—¶å“åº”ï¼Œé‡‡å–æœæ–­æªæ–½ï¼Ÿ
+ æ”¿åºœæ˜¯å¦å¯ä»¥ç‰ºç‰²å°‘æ•°æ°‘ä¼—æƒåˆ©ï¼Œæ¥æ¢å–å¤§å¤šæ•°ç¤¾ä¼šæˆå‘˜çš„å…¬å…±å«ç”Ÿå®‰å…¨ï¼Ÿ
:::

:::{.fragment}
$$
\text{1PL: }\color{red}{P(Y_{iq} = 1)} = \color{blue}{logist^{-1}(\theta_i - \sigma_q)},
$$
:::

:::{.fragment}
$$
\color{red}{é¡¹ç›®ååº”} = \color{blue}{ååº”ç†è®º}.
$$
:::


## æ¼”ç¤ºæ¡ˆä¾‹ [@BockLieberman1970]

:::: {.columns}

::: {.column .fragment width="50%"}
Law School Admissions Test    
sec 7, 5ä¸ªyes/noé—®é¢˜

```{r data-verbal}
df_lsat <- expand.table(LSAT7)
df_lsat
```

:::

::: {.column width="50%"}
![](https://drhuyue.site:10002/sammo3182/figure/lv_lsat.jpg){fig-align="center" height=600}
:::

::::

:::{.notes}
[`mirt` Workshop 1](http://philchalmers.github.io/mirt/extra/mirt-Workshop-2015_Day-1.pdf)
:::

## Difficulty Parameter

:::: {.columns}

::: {.column width="30%"}
```{r rasch-difficulty}
m_lsat <- mirt(df_lsat, model = 1, itemtype = "Rasch", verbose = FALSE)
coef(m_lsat, simplify = TRUE)$item
```
:::

::: {.column width="70%"}
```{r icc}
#| fig-cap: "Item Characteristic Curves"

trellis.par.set(
  par.xlab.text = list(cex = 4),
  par.ylab.text = list(cex = 4),
  par.main.text = list(cex = 4)
)

plot(
  m_lsat,
  type = "trace",
  facet_items = FALSE,
  par.settings = list(
    axis.text = list(cex = 4) # Adjusts the size of axis tick labels
  )
)

```

:::

::::

:::{.notes}
æ£€æŸ¥å„é¢˜affirmativeçš„éš¾æ˜“ç¨‹åº¦ï¼Œçœ‹é€ä¸ªæ˜¯ä¸æ˜¯å¤§ä½“åŒä¸€ä¸ªè¶‹åŠ¿
:::


## Test Characteristic Curve

```{r tcc}
plot(m_lsat,
     type = "infoSE",
     par.settings = list(
       axis.text = list(cex = 4) # Adjusts the size of axis tick labels
     ))
```

:::{.notes}
TCCï¼š æ‰€æœ‰ICCä¹‹å’Œï¼Œä½“ç°how reliable, information ç†æƒ³æ˜¯å½¢æˆä¸€ä¸ªé’Ÿå½¢,é¡¶å°–å¤„ä»£è¡¨å¹³å‡æ°´å¹³ï¼Œæ®æ­¤å¯¹æ¯”ä¸ªäºº&theta;å¯ä»¥åˆ¤æ–­è¿™äººæ˜¯å¦æ˜¯outlier
SE(&theta;) = (test)<sup>-1/2</sup>
:::


## 1PL &rarr; 2PL {auto-animate=true}

Raschå±€é™ï¼šMeasurement error

$$
\begin{align}
\text{Rasch: } P(Y_{iq} = 1) =& logist^{-1}(\theta_i - \sigma_q),\\
\text{2PL: } P(Y_{iq} = 1) =& logist^{-1}(\color{red}{\kappa_q}\theta_i - \sigma_q),
\end{align}
$$


&kappa;<sub>q</sub>: Discrimination (Parameter of dispersion)

å¦ä¸€ç§å¸¸è§å†™æ³•

$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\theta_i - {\color{red}{\beta_q}}}{\color{red}{\alpha_q}}]$$

- &alpha;<sub>q</sub>: Dispersion

:::{.notes}
Dispersion: magnitude of the measurement error 

äººä»¬å¯¹åŒä¸€ä¸ªé¢˜ç†è§£ä¸åŒï¼Œå›ç­”å‡ºaffirmativeç­”æ¡ˆå¯èƒ½æ€§ä¹Ÿä¸åŒã€‚

Discrimination: how well a question can differentiate people from below to above;

Rule of thumb above 1 meaning a good question in terms of examination
:::


## Difficulty vs. Dispersion (Statistically) {auto-animate=true}

$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\theta_i - {\color{blue}{\beta_q}}}{\color{red}{\alpha_q}}]$$

```{r irt-illustration}
#| fig-align: center

tibble(
  theta = rep(seq(-3, 3, length.out = 100), 6),
  beta = rep(c(-2, 0, 2, 0, 0, 0), each = 100),
  alpha = rep(c(1, 1, 1, .25, 1, 2), each = 100),
  pr_y = plogis((theta - beta) / alpha),
  line_no = rep(1:6, each = 100),
  plot_facet = rep(
    c("Varying Question Difficulty", "Varying Question Dispersion"),
    each = 300
  )
) %>%
  ggplot(aes(theta, pr_y, group = line_no)) +
  geom_line() +
  facet_wrap(~ plot_facet) +
  xlab(TeX("Individual Unbounded Latent Trait $\\theta'_{i}$")) +
  ylab(TeX("Pr(y_{iq} = 1)")) +
  theme_bw() +
  theme(
    strip.background = element_rect(colour = "white", fill = "white"),
    plot.title.position = "plot"
  ) +
  scale_x_continuous(breaks = seq(-3, 3, 1)) +
  geom_text(
    data = tibble(
      theta = -2.25,
      pr_y = .65,
      line_no = 1,
      plot_facet = "Varying Question Difficulty",
    ),
    label = TeX("$\\beta_1 = -2$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = -.6,
      pr_y = .525,
      line_no = 1,
      plot_facet = "Varying Question Difficulty",
    ),
    label = TeX("$\\beta_2 = 0$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = .9,
      pr_y = .4,
      line_no = 1,
      plot_facet = "Varying Question Difficulty",
    ),
    label = TeX("$\\beta_3 = 2$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = 2.5,
      pr_y = 0.025,
      line_no = 1,
      plot_facet = "Varying Question Difficulty",
    ),
    label = TeX("$\\alpha_q = 1$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = -.03,
      pr_y = .96,
      line_no = 1,
      plot_facet = "Varying Question Dispersion",
    ),
    label = TeX("$\\alpha_1 = .25$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = 1.4,
      pr_y = .9,
      line_no = 1,
      plot_facet = "Varying Question Dispersion",
    ),
    label = TeX("$\\alpha_2 = 1$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = 2.1,
      pr_y = .66,
      line_no = 1,
      plot_facet = "Varying Question Dispersion",
    ),
    label = TeX("$\\alpha_3 = 2$", output = "character"),
    parse = TRUE
  ) +
  geom_text(
    data = tibble(
      theta = 2.5,
      pr_y = 0.025,
      line_no = 1,
      plot_facet = "Varying Question Dispersion",
    ),
    label = TeX("$\\beta_q = 0$", output = "character"),
    parse = TRUE
  )
```

:::{.notes}
- &beta;<sub>q</sub>: &sigma;<sub>q</sub> &frasl; &kappa;<sub>q</sub>, threshold("difficulty", æ§åˆ¶location)
- &alpha;<sub>q</sub>: &kappa;<sub>q</sub><sup>-1</sup>, dispersion (æ§åˆ¶æ–œç‡)
:::


## Difficulty vs. Dispersion (Substantively)

:::{.r-hstack}
![Difficulty](https://drhuyue.site:10002/sammo3182/figure/lv_triDimensionalChess.jpg){.fragment fig-align="center" height=500}

![Dispersion](https://drhuyue.site:10002/sammo3182/figure/lv_goes.jpg){.fragment fig-align="center" height=500}
:::

## Estimation

:::: {.columns}

::: {.column width="50%"}
**Rasch**

```{r outcome-1pl}
coef(m_lsat, simplify = TRUE)$item
```

:::

::: {.column .fragment width="50%"}
**2PL**

```{r outcome-2pl}
m_lsat2PL <-  mirt(df_lsat, model = 1, itemtype = "2PL", verbose = FALSE)
coef(m_lsat2PL, simplify = TRUE)$item
```
:::

::::

:::{.fragment}

:::{.callout-tip}

## ä½ çœŸçš„éœ€è¦2PLå—?

```{r llr}
anova(m_lsat, m_lsat2PL) %>%  
  select(AIC, SABIC, HQ, logLik, df, p) %>% 
  kable(caption = "Likelihood-Ratio Test")
```

:::

:::


## 2PL &rarr; 3PL &rarr; 4PL 

å¦‚æœå‘ç»™äº†åˆä¸­ç”Ÿé«˜ä¸­æ•°å­¦é¢˜ï¼Ÿ&rarr; Three-Parameter Logistic Model (3PL)

:::{.notes}
å…¨å‡­çŒœ &rarr; å¤§é‡ä½&theta;äººç¾¤
:::

:::{.fragment}
$$Pr(y_{iq} = 1) = \color{red}{c_i + (1 - c_i)}logist^{-1}[\frac{(\theta_i - \beta_q)}{\alpha_q}],$$ c<sub>i</sub>ï¼šItem [lower]{.red} asymptote ("guessing")
:::


:::{.notes}
æå¤§å¢åŠ æ¼”ç®—æˆæœ¬&rarr;é€šå¸¸éœ€è¦1000ä»¥ä¸Šè§‚æµ‹ç‚¹
:::

:::{.fragment}
å¦‚æœæœ‰äººä¸careå’‹åŠ &rarr; Four-Parameter Logistic Model (4PL)

$$Pr(y_{iq} = 1) = c_i + (\color{red}{d_i} - c_i)logist^{-1}[\frac{(\theta_i - \beta_q)}{\alpha_q}], $$ d<sub>i</sub>ï¼šItem [upper]{.red} asymptote ("carelessness"), d < 1
:::


:::{.notes}
é‰´äº3PLå·²ç»éœ€è¦1000-ishè§‚æµ‹ç‚¹â€¦â€¦
:::

## IRT Diagnosis

:::{.large .nonincremental style="text-align:center; margin-top: 2em"}
+ æµ‹è¯•å±‚ï¼šGlobal fit
+ é¡¹ç›®å±‚ï¼šItem fit & residual
+ ååº”è€…å±‚ï¼šPersonal fit
:::



## Global Fit<sup>1</sup>


$G^2 = 2[\sum_l^s r_lln(\frac{r_l}{N\tilde{P}_l})],$^[RMSEA, SRMSR, CFI, TLIå¯¹äºIRTåŒæ ·ä½¿ç”¨.]

N: å‚ä¸äººæ•°  
l: å¯èƒ½çš„ååº”  
r: åšå‡ºç‰¹å®šååº”çš„äººæ•°


::: {.fragment}
å½“æ•°æ®è¿‡äºç¨€ç–æ—¶(item > 10)ï¼ŒM2, M2* 

```{r diagnostics-overall}
M2(m_lsat)
```
:::

:::{.notes}
REDO: @Maydeu-Olivares2013

N is the number of subjects, L is number of possible response patterns, $P_ l$ is the estimated probability of observing response pattern l, and $r_ l$ is the number of subjects who have response pattern l

- &chi; sig   
- Tucker-lewis index, 1 ideal, < .95 poor   
- Comparative fit index, the same   
- Root mean square error of approximation, 0 perfect, <.05 good, [.05, .08] ok, > .1 poor    
- Standardized root mean square residual <.08 acceptable
:::


## Item Diagnostics

:::: {.columns}

::: {.column width="50%"}
*Covariation-based residuals*

```{r diagnostics-residual}
residuals(m_lsat)
```

- å¤šç”¨äºæ£€éªŒmultidimensionality

:::{.notes}
çœ‹item residualçš„åå˜ç¨‹åº¦ï¼Œunidimnesionality èšåˆçš„é¡¹ç›®å‡æŒ‡å‘åŒä¸€ä¸ªæ½œåœ¨å˜é‡ï¼Œ ä¸åº”æœ‰å…³è”
:::
:::

::: {.column width="50%"}
*Single item/person fit*

```{r item-fit}
# Item 
itemfit(m_lsat, fit_stats = "infit")
```

:::{.fragment}
```{r person-fit}
# Person
personfit(m_lsat)
```
:::


:::{.notes}
infit/outfit, close to 1 is good

Z<sub>h</sub> > 0 better
:::

:::

::::


## å¦‚æœå‡ºç°é—®é¢˜

1. é€šè¿‡S-&chi;<sup>2</sup>ã€local dependencyç­‰æ£€æŸ¥è§‚æµ‹å’Œä¼°è®¡æ•°å€¼å·®åˆ«
1. å¢åŠ æ¨¡å‹å¤æ‚ç¨‹åº¦, æ¯”å¦‚2PL &rarr; 3PL
1. å¦‚æœæœ€åˆç”¨binaryï¼Œå°è¯•polytomousæˆ–è€…nominal response models
1. å°è¯•non-parametric smoothing techniques

## å°ç»“

:::: {.columns}

::: {.column width="50%"}
- é¡¹ç›®ååº”ç†è®ºï¼ˆIRTï¼‰
  - é¡¹ç›®ï¼šé¢˜
  - ååº”ï¼šåšé¢˜
- IRT å‡å®š
  - Monotonicity
  - Unidimensionality
  - Local independence
  - Parameter invariance
:::

::: {.column .fragment width="50%"}
- IRT æ¨¡å‹æ¼”è¿›
  - Rasch Model
  - 2PL, 3PL, 4PL
- IRT è¯Šæ–­
  - Global fit
  - Item fit & residual
  - Personal fit
:::

::::



# å‘å±•çš„é¡¹ç›®ååº”ç†è®º

## å‘å±•æ–¹å‘

:::{.fragment .nonincremental}
- ä¸ªä½“å±‚çº§
    - ä¸€ç»´åˆ°å¤šç»´
    - äºŒåˆ†åˆ°å¤šç±»
    - å•å±‚åˆ°å¤šå±‚
:::

:::{.fragment .nonincremental}
- ç¾¤ä½“å±‚çº§
    - æ›´å‡†ç¡®çš„ã€å¯æ¯”è¾ƒçš„ç¾¤ä½“å·®å¼‚
:::


## ä¸€ç»´åˆ°å¤šç»´

Multidimentional IRT [MIRT, @Chalmers2015]

$$Pr(y_{iq} = 1) = logist^{-1}[\frac{\boldsymbol{\theta_i} - \beta_q}{\boldsymbol{\alpha_q}}]$$

:::{.callout-note}
**&theta;<sub>i</sub>**å’Œ**&alpha;<sub>q</sub>**ä¸å†æ˜¯å•ä¸€å€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªçŸ©é˜µã€‚
:::


## äºŒåˆ†åˆ°å¤šç±»

:::: {.columns}

::: {.column width="65%"}
Logit &rarr; Cumulative logit

$$P(Y_{iq} = 1) \rightarrow Pr(\frac{Y_{iq}\leq c}{Y_{iq}>c}).$$

```{r twoDimension}
m_lsat2D <- mirt(df_lsat, model = 2, verbose = FALSE)
plot(m_lsat2D, type = "score")
```
:::

::: {.column .fragment width="35%"}
*ä¸‰ç§ä¸»è¦ç±»å‹*

1. (Modified) Graded Response Model
    + ç”¨äºscoring rubricsï¼Œæ¯”å¦‚ Likert
1. (Generalized) Partial Credit Modelï¼ŒRating Scale Model
    + ç”¨äºå¯è½¬åŒ–ä¸ºå®šåºçš„åˆ†ç±»å˜é‡
1. Nominal Response Model
    + ç”¨äºæ— åºåˆ†ç±»å˜é‡

:::{.notes}
https://stats.stackexchange.com/questions/402440/how-should-we-select-between-various-item-response-theory-models-e-g-rsm-grm

:::
:::

::::

## å•å±‚åˆ°å¤šå±‚

![](https://drhuyue.site:10002/sammo3182/figure/countryBias.png){fig-align="center" height=300}

Multilevel Mixture IRT with Item Bias Effects [@Stegmueller2011]

åœ¨ä¼°æµ‹&alpha;<sub>q</sub>æ—¶åŠ å…¥random effect.

:::{.notes}
Daniel Stegmueller, Duke U, poli sci
:::



## è¶…è¶Šä¸ªä½“

Conquer the individual fallacy

:::{.r-stack}
![](https://drhuyue.site:10002/sammo3182/figure/lv_maleFeminist.jpg){fig-align="center" .fragment height=500}

![](https://drhuyue.site:10002/sammo3182/figure/lv_incomeGap.jpg){.fragment fig-align="center" height=500}
:::


:::{.notes}
Ecological fallacy (Simpson's paradox)

![](https://drhuyue.site:10002/sammo3182/figure/ea_yuleSimpson.gif){fig-align="center" height=600}

å†æ¯”å¦‚ï¼Œæ°‘ä¸»ã€ä¸å¹³ç­‰ã€æ”¿æ²»æ–‡åŒ–â€¦â€¦
:::



## èšåˆå±‚çº§ä¸Šçš„å°è¯• [@CaugheyWarshaw2015]

**Dynamic Group-level IRTï¼ˆDGIRT)**


:::: {.columns}

::: {.column .fragment width="50%"}

*èšåˆï¼ˆGroup-levelï¼‰*ï¼š

$\eta_{ktq} = logit^{-1}(\frac{\color{red}{\bar{\theta}_{kt}}- \beta_q}{\sqrt{\alpha^2_q + \color{red}{(1.7\sigma_{kt})^2}}}),$ 

$\bar{\theta}_k$ å’Œ &sigma;<sub>kt</sub> æ˜¯æ½œåœ¨å˜é‡åœ¨ç»„kæ—¶é—´tçš„å‡å€¼å’ŒSDã€‚

:::{.notes}

1. åœ¨ç¾¤ç»„å±‚é¢ä¼°æµ‹IRTï¼›^[ä¸ªä½“ï¼š$p_{iq} = logist^{-1}[\frac{\theta_i - {\beta_q}}{\alpha_q}].$]
1. åœ¨ä¼°æµ‹IRTè¿‡ç¨‹ä¸­åŠ å…¥ç¾¤ç»„çº§åˆ«å˜é‡ï¼›
1. å°†æ—¶é—´å˜é‡èå…¥IRTä¼°æµ‹ï¼›
1. ç”¨[MrP](#sec-mrp)ç»™ä¼°æµ‹è¿›è¡Œæƒé‡ã€‚


1.7: sd of probit is (&pi;/3)<sup>1/2</sup> for logit, while Long 1997 found it is more close to 1.7 in actual estimations.

Mislevy, Robert J. 1983. â€œItem Response Models for Grouped Data.â€ Journal of Educational Statistics 8(4): 271â€“88.

&eta;: eta 
:::

:::

::: {.column .fragment width="50%"}

*å›Šæ‹¬æ—¶é—´ä¸ç©ºé—´ (Dynamic)*

$$
\begin{align}
\bar{\theta}_k\sim& N(\xi_t + \boldsymbol{x'_k\gamma}, \sigma^2_{\bar{\theta}}), \\
\xi_t \sim& N(\xi_{t-1}, \sigma^2_{\gamma}), \\
\gamma_{pt} \sim& N(\gamma_{p,t-1}, \delta_t + \boldsymbol{z'_p.\eta_t}, \sigma^2_{\gamma})
\end{align}
$$ 

:::{.notes}
&xi;<sub>t</sub>: xi

x ä¸ºç¾¤ç»„çº§å˜é‡  

t-1, dynamic linear model  

**z'<sub>p.</sub>&eta;<sub>t</sub>**: geography-level attributes, &eta;æ˜¯coefficients  

n<sup>*</sup><sub>kqt</sub>åŸºäºMrP
:::
:::

::::


:::{.fragment style="text-align:center"}

*æ•ˆæœ*ï¼š

+ å›Šæ‹¬è¯¸å¤šå› ç´ 
+ å¯ä»¥éƒ¨åˆ†å¹³è¡¡æ ·æœ¬ä»£è¡¨æ€§é—®é¢˜
+ å¼ºå¤§ï¼Œä½†[å¤æ‚]{.red}

:::

:::{.notes}
Caughey & Warshawç§°ä¼šè·‘å‡ ä¸ªæ˜ŸæœŸ
:::


## ç®€åŒ–DGIRT [@Claassen2019]

$$
\begin{align}
\eta_{ktq} = logit^{-1}&(\frac{\bar{\theta}'_{kt}- \beta_q}{\sqrt{\alpha^2_q + (1.7\sigma_{kt})^2}}).\\
\downarrow&\\
\eta_{ktq} = logit^{-1}&(\frac{\bar{\theta}'_{kt}- (\beta_q \color{red}{+ \delta_{kq}})}{\alpha_q}).
\end{align}
$$

:::{.notes}
&delta;<sub>kq</sub>: é—®é¢˜çš„difficultyéšå›½å®¶kå˜åŒ–ã€‚
:::

1. åªä½œç”¨äºä»£è¡¨æ€§æ ·æœ¬å’Œ[å›½å®¶]{.red}çº§åˆ«  
1. åªå¯¹äºŒåˆ†å˜é‡è¿›è¡Œåˆ†æ
1. å°†å›½å®¶ä½œç”¨ä»ä¼°æµ‹&theta;å˜ä¸ºä¼°æµ‹difficulty  
1. å‡å®šæœ¬åœ°é¡¹ç›®æ­£æ€åˆ†å¸ƒï¼ˆå¿½ç•¥æåŒ–ç­‰ç°è±¡ğŸ˜±ï¼‰



## èšåˆIRTä¿®æ­£ç‰ˆ [@Solt2020a]

:::: {.columns}

::: {.column width="50%"}
![](https://drhuyue.site:10002/sammo3182/figure/fsolt.jpeg){fig-align="center" height=400}
:::

::: {.column width="50%"}
[[D]{.red}ynamic [C]{.red}omparative [P]{.red}ublic [O]{.red}pinion](https://dcpo.org/team/)

:::{.fragment}
å¤æ‚ç¨‹åº¦ï¼š

Claasseen 2019 < DCPO < DGIRT
:::

:::{.fragment}
å‘è¡¨ï¼š

- *APSR*[@TaiEtAl2024]
- *BJPS*[@WooEtAl2023]
- *PSRM*[@HuEtAl2024a]
- *SSQ*[@WooEtAl2024]

......
:::


:::

::::

## æ“ä½œ

1. æ”¶é›†surveyæ•°æ®ï¼Œæ˜ç¡®ä¸æ„Ÿå…´è¶£çš„å˜é‡ç›¸å…³çš„æŒ‡æ ‡é—®é¢˜ï¼ˆæ‰‹åŠ¨ï¼‰
1. é€šè¿‡`DCPOtools`å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆåŠè‡ªåŠ¨ï¼‰
1. é€šè¿‡`DCPO`è¿›è¡Œæ•°æ®åˆ†æï¼ˆè‡ªåŠ¨ï¼‰
1. é€šè¿‡`shinystan`è¯Šæ–­convergenceï¼ˆè‡ªåŠ¨ï¼‰

:::{.fragment}
:::{.callout-important}
## åƒä¸‡æ³¨æ„ï¼

å¦‚åŒå…¶ä»–æ–¹æ³•ä¸€æ ·ï¼ŒèšåˆIRTä¹Ÿéœ€è¦å¯¹ç»“æœä¸æ•°æ®æ‹Ÿåˆç¨‹åº¦è¿›è¡Œè¯Šæ–­ã€‚
DCPOç­‰èšåˆIRTæ–¹æ³•ä½¿ç”¨è´å¶æ–¯ç»Ÿè®¡æ¡†æ¶ï¼Œç»“æœéœ€è¦å¯¹[reccurence, stationarity, aperodicityç­‰](@sec-bayesian)è¿›è¡Œæ£€éªŒã€‚
:::
:::



## æ•ˆæœä¸ä¼˜åŠ¿

:::{.r-stack}
![](https://drhuyue.site:10002/sammo3182/figure/irtCompare.png){fig-align="center" height=600}

![](https://drhuyue.site:10002/sammo3182/figure/irtFitCompare.png){.fragment fig-align="center"}
:::


:::{.notes}
Bounded: ä½¿ç”¨logitå½’ä¸º0-1
:::

## æœ€æ–°è¿›å±• [â€œç©¶æå½¢æ€â€ï¼Ÿ, @BerwickCaughey2025]



::::{.overlay-container}

:::{.overlay-image}
![](https://drhuyue.site:10002/sammo3182/figure/lv_modgirt.png){fig-align="center" height=600}
:::

:::{.overlay-text-over .fragment}
[Multidimensional]{.red}, multilevel IRT

- **Strengths**
  - Flexible: Single-country or cross-national datasets
  - Extensible: Overdispersion, differential item functioning, and predictors.

- **Considerations**
  - Computationally intensive (Bayesian estimation).
  - Needs bridging items for comparability across groups/time.

:::

::::

## æ€»ç»“

:::: {.columns}

::: {.column width="50%"}
*è¿ç»­å› å­æ¨¡å‹*

- è§£å†³é—®é¢˜ï¼šæ½œåœ¨å˜é‡æè¿°ä¸å…³ç³»æ£€éªŒ
- æ¢ç´¢æ€§å› å­åˆ†æ(EFA)
    - æ½œåœ¨å› å­æ¢ç´¢
- éªŒè¯æ€§å› å­åˆ†æ(CFA)
    - ç»Ÿè®¡æ¨æ–­
- ç»“æ„æ–¹ç¨‹æ¨¡å‹(SEM)
    - æ½œåœ¨å˜é‡ä¸å¤–ç”Ÿå˜é‡å…³ç³»

:::{.callout-tip .fragment}
## ä½¿ç”¨å»ºè®®

- æ²¡æœ‰é«˜ä½ä¹‹åˆ†
- ç¡®æœ‰éš¾æ˜“ä¹‹åˆ«
- å…³é”®æ˜¯æ–¹æ³•çš„[æ°å½“]{.red}åº”ç”¨å’Œ[è¯Šæ–­]{.red}
:::

:::

::: {.column width="50%"}
*ç¦»æ•£å›åº”æ¨¡å‹*

- è§£å†³é—®é¢˜ï¼šModelingéè¿ç»­æ€§æŒ‡æ ‡
- IRT
  - Raschï¼ŒnPL
  - Diagnoses: æ€»ä½“/item/respondent
  - å‘å±•
    - å¤šç»´ã€å¤šç±»ã€å¤šå±‚
- GIRT
  - è§£å†³é—®é¢˜ï¼šIndividual fallacy
  - DGIRT, Claassen model
  - DCPO, MODGIRT
:::

::::


## å‚è€ƒæ–‡çŒ® {.unnumbered}

::: {#refs}
:::