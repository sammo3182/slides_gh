---
title: "æ½œå˜é‡åˆ†æï¼ˆå‰æ²¿ï¼‰"
subtitle: "è®¡ç®—æ”¿æ²»å­¦è®²ä¹ ç­"
author: "èƒ¡æ‚¦"
institute: "æ¸…åå¤§å­¦ç¤¾ä¼šç§‘å­¦å­¦é™¢" 
bibliography: [t_politicalData.bib, ../../conference/main_wrangling.bib]

format: 
    revealjs:
        css: https://www.drhuyue.site/slides_gh/css/style_basic.css
        theme: ../../../css/goldenBlack.scss
        number-sections: true
        slide-number: true
        filters: [appExclusion.lua] # not count appendices into page number
        incremental: false
        preview-links: true # open an iframe for a link
        link-external-newwindow: true
        self-contained: false
        chalkboard: false # allwoing chalk board B, notes canvas C
        # callout-icon: false
        show-slide-number: all # `speaker` only print in pdf, `all` shows all the time
        show-notes: false
        title-slide-attributes:
            data-background-image: https://gitlab.com/sammo3182/backup/raw/85b3c1ad4b459d7a9f901f124b936428eda5fcaf/logo_THPS.png?inline=true
            data-background-size: 250px   
            data-background-position: top 10% right 5%
        default-image-extension: png
revealjs-plugins:
    - spotlight
lightbox: 
    match: auto
    effect: fade
spotlight:
    size: 50
    presentingCursor: default
    toggleSpotlightOnMouseDown: false
    spotlightOnKeyPressAndHold: 73 # keycode for "i"

execute: 
    echo: false
editor_options: 
    chunk_output_type: console
editor: 
    render-on-save: true
---

## æ¦‚è¿°

1. æ½œå˜é‡åˆ†æåŸºç¡€ï¼ˆå¤ä¹ ï¼‰
2. ç¾¤ç»„åŠ æƒå¹³å‡ï¼ˆMRPï¼‰
3. ç¾¤ç»„é¡¹ç›®ååº”ç†è®ºä¹‹é“
4. æ½œå˜é‡åˆ†æçš„ç»´åº¦é€‰æ‹©

# æ½œå˜é‡åˆ†æåŸºç¡€

```{r}
#| label: setup
#| include: false

library(pacman)

p_load(
  psych,
  lavaan,
  drhutools,
  semPlot,
  qgraph,
  haven,
  here,
  corrplot,
  FactoMineR,
  vcd,
  factoextra,
  ltm,
  mirt,
  TeachingSampling,
  lme4,
  ggalt,
  DCPO,
  latex2exp,
  knitr,
  kableExtra,
  here,
  icons,
  tidyverse
)

# Functions preload
set.seed(313)

theme_set(
  theme_minimal(base_size = 18)
)

theme_update(
  plot.title = element_text(size = 18),
  axis.title = element_text(size = 22),
  axis.text = element_text(size = 18)
)
```


## è§£å†³çš„é—®é¢˜

> Vaild [latent variable] measurement is the [cornerstone]{.red} of successful scientific inquiry [@CarpiniKeeter1993, p. 1203].


:::: {.columns}

::: {.column width="30%"}

æ¶µç›–æ‰€æœ‰ç¤¾ç§‘å­¦ç§‘

* æŠ½è±¡
* å¤æ‚
* ç»¼åˆ


:::

::: {.column .fragment width="30%"}

æ“ä½œæ€§æŒ‘æˆ˜

1. ä¸å¯è§(Unobservable)
1. æœ‰æ•ˆæœ(Consequential)
1. **å¤šç»´åº¦(Multidimensional)**

:::

::: {.column width="40%"}

![[@Stimson1991]](https://drhuyue.site:10002/sammo3182/figure/lv_jamesStimson.jpg){.fragment fig-align="center" height=400}

:::

::::

:::{.notes}

å…œé‡Œæœ‰å¤šå°‘é’±ï¼Œä¸å¯è§ï¼Œä½†ç»´åº¦å•ä¸€ï¼Œä¸å®œç”¨æ½œå˜é‡åˆ†æï¼Œæ›´å¥½çš„åŠæ³•æ˜¯ç¿»å…œ

The latent variable per se can't be directly measured. But its consequences in opinions and behaviors can be observed.

:::

## å¹³å‡å€¼ä¸ºä»€ä¹ˆä¸è¡Œ

:::: {.columns}

::: {.column width="50%"}

æŒ‡æ ‡é—®é¢˜ï¼ˆ1~10ï¼‰ï¼š

1. æ‚¨æ˜¯å¦ä¿¡ä»»èº«è¾¹äººï¼Ÿ
1. æ‚¨åœ¨æ”¿åºœæœºå…³æœ‰æ²¡æœ‰äº²æˆšï¼Ÿ
1. æ‚¨çš„æœ‹å‹æ˜¯å¦å’Œæ‚¨çš„æƒ³æ³•ç»å¸¸ä¸€è‡´ï¼Ÿ


ç´¯åŠ ç»¼åˆæ³•(additive scales)

$$\tilde{X} = (X_1 + X_2 + X_3)/3.$$

:::

::: {.column .fragment width="50%"}

*æ½œåœ¨é—®é¢˜*

1. ç›¸åŒæƒé‡(equal weight)
1. ç»“æœä¸ç¨³(extreme value sensitivity)
1. å¿½ç•¥æåŒ–(polarity ignoring)

:::

::::

:::{.fragment .large style="text-align:center; margin-top: 2em"}

*å¦‚ä½•åšå¾—æ›´å¥½ï¼Ÿ*

:::

## æ½œå˜é‡åˆ†æå¸¸è§æ–¹æ³•

:::: {.columns}

::: {.column width="50%"}

**è¿ç»­å› å­æ¨¡å‹**

1. æ¢ç´¢æ€§å› å­åˆ†æ(EFA)
1. ç»“æ„æ–¹ç¨‹æ¨¡å‹(SEM)

:::

::: {.column .fragment width="50%"}

**ç¦»æ•£å›åº”æ¨¡å‹**

- é¡¹ç›®ååº”ç†è®º(IRT)
    - é¡¹ç›®ååº”ç¾¤ç»„ä¼°è®¡

:::

::::

::: {.callout-warning .fragment style="text-align:center; margin-top: 2em"}

## å¾…è§£ä¹‹é¢˜

1. å¦‚ä½•è®¡ç®—ä¸€ä¸ªæ›´[é è°±]{.red}çš„å¹³å‡å€¼
2. å¦‚ä½•[æ­£ç¡®]{.red}ä½¿ç”¨ç¾¤ç»„æ½œå˜é‡åˆ†æ
3. å¦‚ä½•åˆ¤æ–­æ½œå˜é‡çš„[ç»´åº¦]{.red}

:::

# ç¾¤ç»„åŠ æƒå¹³å‡è®¡ç®—

## å¹³å‡å€¼åœ¨ç¾¤ç»„å±‚é¢çš„é—®é¢˜
$$Y_{kq} = \frac{\sum Y_{ikq}}{n}.$$

:::{style="text-align:center"}

ä¸å¦¥ä¹‹å¤„ï¼Ÿ

::: {.fragment}

1. å¦‚æœç¾¤ç»„è¿‡å°ï¼Œå…¶å¹³å‡å€¼çš„ä»£è¡¨æ„ä¹‰ä¸å¤§
2. ä¸åŒçš„æŒ‡æ ‡å¯¹äºæ½œåœ¨å˜é‡è´¡çŒ®ä¸ä¸€æ ·

:::

:::{.fragment}

[&darr;]{.large}

ç»è¿‡ç¾¤ç»„ä¿¡æ¯ï¼ˆåœ°ç†ã€äººå£ï¼‰åŠ æƒçš„å¹³å‡å€¼    

Multilevel Regression and Post-stratification [MRP, @GelmanLittle1997]

:::

:::

## Get the mean right

$$
\theta_h = \frac{\sum_{j \in h} N_j \color{red}{\mu_j} }{\sum_{j \in h} n_j},
$$

:::{style="text-align:center"}

N: æ€»ä½“ï¼ˆæ¥è‡ªæ™®æŸ¥ï¼‰  
n: æ ·æœ¬ï¼ˆæ¥è‡ªsampleï¼‰

:::

1. å°†æ€»ä½“ï¼ˆpopulationï¼‰æŒ‰ç¾¤ç»„ï¼ˆstrataï¼Œå¦‚å›½å®¶ã€åœ°åŒºï¼‰[åˆ‡åˆ†]{.red}ï¼›
1. ä¼°æµ‹å¯¹è±¡ä¸ºæ ¸å¿ƒå˜é‡åœ¨[æ¯ä¸ªç¾¤ç»„]{.red}ä¸­çš„å¹³å‡å€¼/æ¯”ä¾‹ï¼Œ &theta;<sub>h</sub> (h &isin; {1, H});
1. å·²çŸ¥å„ç¾¤ç»„ä»¥äººå£å˜é‡jï¼ˆå¦‚è€å¹´ç”·æ€§ã€é’å¹´å¥³æ€§ç­‰ï¼‰åˆ’åˆ†ï¼Œç¡®å®š[ç¾¤ç»„äººå£]{.red}ï¼ˆN<sub>j</sub>ï¼‰æˆ–å æ€»äººå£æ¯”ï¼›
1. é€šè¿‡[multilevel model]{.red}è¿›è¡Œä¼°ç®—å„ç»„æ€»ä½“å¹³å‡å€¼&mu;<sub>j</sub>ã€‚



## ä¸€ä¸ªç»æµå­¦ğŸŒ°

æ•°æ®ï¼šæŸå¹´æŸå¸‚äº”åŒºåŸŸ2396å®¶äº§ä¸šå…¬å¸çš„è´¢æ”¿ä¿¡æ¯  
ç›®æ ‡ï¼šä¼°æµ‹æ¯ä¸ªåŒºåŸŸçš„äº§ä¸šå¹³å‡æ”¶å…¥

:::: {.columns}

::: {.column width="70%"}

å…¬å¸è§„æ¨¡å’ŒåŒºåŸŸåˆ†å¸ƒ

```{r}
#| label: descriptive-level

data(Lucy)
table(Lucy$Level, Lucy$Zone) %>%
  kable()
```

:::

::: {.column .fragment width="30%"}

æ€»ä½“å¹³å‡å€¼ï¼ˆçœŸå€¼ï¼‰

```{r}
#| label: trueMean

tb_true <- group_by(Lucy, Zone) %>%
  summarise(income = mean(Income))
tb_true %>%
  kable(digits = 2)
```

:::

::::


:::{.notes}

https://www.r-bloggers.com/gelmans-mrp-in-r-what-is-this-all-about/

:::

## æ ·æœ¬

æˆ‘ä»¬éšæœºé€‰å–æ•°æ®ä¸­1000ä¸ªäº§ä¸šå…¬å¸ä½œä¸ºæ ·æœ¬ã€‚
å¦‚æœç›´æ¥å„ç»„å–å¹³å‡å€¼çš„è¯å°±ä¼šäº§ç”Ÿåå·®ï¼š

```{r}
#| label: rawsVsTrue

SLucy <- sample_n(Lucy, size = 1000)
Np <- table(Lucy$Level, Lucy$Zone)

tb_compare <- group_by(SLucy, Zone) %>%
  summarise(income = mean(Income)) %>%
  left_join(tb_true, by = c("Zone")) %>%
  mutate(incomeTrue = 0, rawDiff = income.x - income.y, )

ggplot(tb_compare, aes(x = incomeTrue, xend = rawDiff, y = Zone)) +
  geom_dumbbell(
    size = 4,
    color = gb_cols("light grey"),
    colour_x = gb_cols("gold"),
    colour_xend = gb_cols("black"),
  ) +
  xlab("Difference from the true value") +
  ylab("Zone")
```


## è®¡ç®—

**Step I: Mr**
$$
\begin{align}
æ”¶å…¥ = \beta_{0z}& + \beta_{1Z=z}å…¬å¸è§„æ¨¡_{iz} + \epsilon_{iz}, \\
\beta_{0z}& = \gamma_{00} + \gamma_{01}åŒºåŸŸ_z + u_{0z}.
\end{align}
$$

Output: Post-strata means ($\mu_z$)

```{r}
#| label: mr

# Step 1: <<MR>> - Multilevel regression
M1 <- lmer(Income ~ Level + (1 | Zone), data = SLucy)
SLucy$Pred <- predict(M1)

# Summary
sum <- group_by(SLucy, Zone, Level) %>%
  summarise(mean2 = mean(Pred))
Mupred <- matrix(sum$mean2, ncol = 5, nrow = 3)

rownames(Mupred) <- levels(SLucy$Level)
colnames(Mupred) <- levels(SLucy$Zone)

Mupred %>% kable(digits = 2)
```

**Step II: P**

```{r}
#| label: p

colSums(Np * Mupred) / count(Lucy, Zone)$n
```


## çŸ«æ­£æ•ˆæœ

```{r}
#| label: mrpVsraw
#| fig-height: 4

tb_compare$mrpDiff <- colSums(Np * Mupred) /
  count(Lucy, Zone)$n -
  tb_compare$income.y

tb_compare %>%
  pivot_longer(rawDiff:mrpDiff, names_to = "methods", values_to = "diff") %>%
  ggplot(aes(x = incomeTrue, xend = diff, y = Zone, color = methods)) +
  geom_dumbbell(
    size = 4,
    colour_x = gb_cols("gold")
  ) +
  scale_color_viridis_d(alpha = 0.5, end = 0.7) +
  xlab("Difference from the true value") +
  ylab("Zone")
```

:::: {.columns}

::: {.column .fragment width="50%"}

::: {.callout-warning}

## MrP æ²¡æœ‰è§£å†³çš„é—®é¢˜

+ ç­”é¢˜éš¾åº¦çš„åœ°åŒºå·®å¼‚
+ é¢˜ç›®çš„scale
+ Measurement error

:::

:::

::: {.column .fragment .large width="50%"}

::: {style="margin-top: 2em"}

&rarr; ç¾¤ç»„IRT

:::

:::

::::



# ç¾¤ç»„IRTä¹‹â€œé“â€

## ç¾¤ç»„IRT

Conquer the individual fallacy

:::{.r-stack}

![](https://drhuyue.site:10002/sammo3182/figure/lv_maleFeminist.jpg){fig-align="center" .fragment height=550}

![](https://drhuyue.site:10002/sammo3182/figure/lv_incomeGap.jpg){.fragment fig-align="center" height=550}

:::


:::{.notes}

Ecological fallacy (Simpson's paradox)

![](https://drhuyue.site:10002/sammo3182/figure/ea_yuleSimpson.gif){fig-align="center" height=600}

å†æ¯”å¦‚ï¼Œæ°‘ä¸»ã€ä¸å¹³ç­‰ã€æ”¿æ²»æ–‡åŒ–â€¦â€¦

:::



## ç¾¤ç»„å±‚çº§ä¸Šçš„å°è¯• [@CaugheyWarshaw2015]

**Dynamic Group-level IRTï¼ˆDGIRTï¼‰**


:::: {.columns}

::: {.column .fragment width="50%"}

*ç¾¤ç»„ï¼ˆGroup-levelï¼‰*ï¼š^[ä¸ªä½“ï¼š$p_{iq} = logist^{-1}[\frac{\theta_i - {\beta_q}}{\alpha_q}].$]

$\eta_{ktq} = logit^{-1}(\frac{\color{red}{\bar{\theta}_{kt}}- \beta_q}{\sqrt{\alpha^2_q + \color{red}{(1.7\sigma_{kt})^2}}}),$ 

$\bar{\theta}_k$ å’Œ &sigma;<sub>kt</sub> æ˜¯æ½œåœ¨å˜é‡åœ¨ç»„kæ—¶é—´tçš„å‡å€¼å’ŒSDã€‚

:::{.notes}

1. åœ¨ä¸ªä½“å±‚é¢ä¼°æµ‹IRTï¼›
1. åœ¨ä¼°æµ‹IRTè¿‡ç¨‹ä¸­åŠ å…¥ç¾¤ç»„çº§åˆ«å˜é‡ï¼›
1. å°†æ—¶é—´å˜é‡èå…¥IRTä¼°æµ‹ï¼›
1. ç”¨[MrP](#sec-mrp)ç»™ä¼°æµ‹è¿›è¡Œæƒé‡ã€‚


1.7: sd of probit is (&pi;/3)<sup>1/2</sup> for logit, while Long 1997 found it is more close to 1.7 in actual estimations.

Mislevy, Robert J. 1983. â€œItem Response Models for Grouped Data.â€ Journal of Educational Statistics 8(4): 271â€“88.

&eta;: eta 

:::

:::

::: {.column .fragment width="50%"}

*çº³å…¥æ—¶ç©º (Dynamic)*

$$
\begin{align}
\bar{\theta}_k\sim& N(\xi_t + \boldsymbol{x'_k\gamma}, \sigma^2_{\bar{\theta}}), \\
\xi_t \sim& N(\xi_{t-1}, \sigma^2_{\gamma}), \\
\gamma_{pt} \sim& N(\gamma_{p,t-1}, \delta_t + \boldsymbol{z'_p.\eta_t}, \sigma^2_{\gamma})
\end{align}
$$ 

:::{.notes}

&xi;<sub>t</sub>: xi

x ä¸ºç¾¤ç»„çº§å˜é‡  

t-1, dynamic linear model  

**z'<sub>p.</sub>&eta;<sub>t</sub>**: geography-level attributes, &eta;æ˜¯coefficients  

n<sup>*</sup><sub>kqt</sub>åŸºäºMrP

:::

:::

::::


:::{.fragment style="text-align:center"}

*æ•ˆæœ*ï¼š

+ å›Šæ‹¬è¯¸å¤šå› ç´ 
+ å¯ä»¥éƒ¨åˆ†å¹³è¡¡æ ·æœ¬ä»£è¡¨æ€§é—®é¢˜
+ å¼ºå¤§ï¼Œä½†[å¤æ‚]{.red}

:::

:::{.notes}

Caughey & Warshawç§°ä¼šè·‘å‡ ä¸ªæ˜ŸæœŸ

:::


## ç®€åŒ–ç‰ˆDGIRT [@Claassen2019]

$$
\begin{align}
\eta_{ktq} = logit^{-1}&(\frac{\bar{\theta}'_{kt}- \beta_q}{\sqrt{\alpha^2_q + (1.7\sigma_{kt})^2}}).\\
\downarrow&\\
\eta_{ktq} = logit^{-1}&(\frac{\bar{\theta}'_{kt}- (\beta_q \color{red}{+ \delta_{kq}})}{\alpha_q}).
\end{align}
$$

:::{.notes}

&delta;<sub>kq</sub>: é—®é¢˜çš„difficultyéšå›½å®¶kå˜åŒ–ã€‚

:::

1. åªä½œç”¨äºä»£è¡¨æ€§æ ·æœ¬å’Œ[å›½å®¶]{.red}çº§åˆ«  
1. åªå¯¹äºŒåˆ†å˜é‡è¿›è¡Œåˆ†æ
1. å°†å›½å®¶ä½œç”¨ä»ä¼°æµ‹&theta;å˜ä¸ºä¼°æµ‹difficulty  
1. å‡å®šæœ¬åœ°é¡¹ç›®æ­£æ€åˆ†å¸ƒï¼ˆå¿½ç•¥æåŒ–ç­‰ç°è±¡ğŸ˜±ï¼‰



## çº åç‰ˆDGIRT [@Solt2020a]

:::: {.columns}

::: {.column width="50%"}

![](https://drhuyue.site:10002/sammo3182/figure/fsolt.jpeg){fig-align="center" height=400}

:::

::: {.column width="50%"}

[[D]{.red}ynamic [C]{.red}omparative [P]{.red}ublic [O]{.red}pinion](https://dcpo.org/team/)

:::{.fragment}

å¤æ‚ç¨‹åº¦ï¼š

Claasseen 2019 < DCPO < DGIRT

:::

:::{.fragment}

å‘è¡¨ï¼š

- *APSR*[@TaiEtAl2024]
- *BJPS*[@WooEtAl2023]
- *PSRM*[@HuEtAl2024a]
- *SSQ*[@WooEtAl2024]

......

:::


:::

::::

## æ•ˆç‡æ¯”è¾ƒ

::::{.overlay-container}

::: {.overlay-image .fragment}

:::{.r-stack}

![](https://drhuyue.site:10002/sammo3182/figure/irtCompare.png){fig-align="center" height=600}

![](https://drhuyue.site:10002/sammo3182/figure/irtFitCompare.png){.fragment fig-align="center"}

:::

:::{.notes}

Bounded: ä½¿ç”¨logitå½’ä¸º0-1

:::

:::

::::


## æ–°æ–¹æ³•é¢ä¸´æ–°æŒ‘æˆ˜

::::{.overlay-container}

::: {.overlay-image}

![Source: [urbanlogiq.com](https://urbanlogiq.com/data-engineering-101-a-guide-for-government-officials/)](https://drhuyue.site:10002/sammo3182/figure/wrangle_risk.png){fig-align="center" height=600}

:::

::: {.overlay-text-over .fragment}

åŠ£è´¨æºæ•°æ® 

\+ 

æ•°æ®æ”¶é›†è¿‡ç¨‹çš„éš¾å¤åˆ»æ€§

\+ 

éš¾ä»¥è¿½è¸ªçš„äººä¸ºæ“ä½œ

:::

::::



::: {.notes}

- The conventional approach usually involves a notorious bulk of manual work on indicator identification, data merging, data scaling, and so on
- Manual wrangling make a full reproducibility of research pipeline more difficulty and undermine the transparency
- Heterogeneous sources increases the risk
    - older survey files stored in SPSS's ASCII or portable formats often require extensive restructuring before they can be merged with new format of data.
- Unfortunately, documentation does not cure everything, esp. the influence of human discretion embedded in manual processing

:::


## é¡¶åˆŠæ•°æ®çš„ä¾‹å­

![](https://drhuyue.site:10002/sammo3182/figure/wrangle_replication.png){fig-align="center" height=600}

::: {.notes}

Here we provide a vivid example from real-life research to show how different results the seemingly basic, well-described hand-entered steps can produce.
We attempted to replicate the spreadsheets applied in prominent studies following the replication instructions of the publications but with a more automatic process (elaborated below).
Points on the diagonal show agreement; points above indicate higher hand-entered values, while points below show lower hand-entered percentages compared to machine-collected data.

For about 85% of country-year-item observations, differences between percentages are negligible-less than half a percent-resulting in points near the plotâ€™s diagonal. 
However, for the remaining cases, differences are significant and cannot be ignored.
These discrepancies stem from decisions on categorization, processing numerators and denominators in ratio calculation, and whether counting respondents excluded from original surveys. 
Though errors introduced during such processes seems minor and may appear as random noise, they can lead to opposite conclusions [@HuEtAl2024a]. 
Such issues pose a major, yet underrecognized, challenge to data harmonization in political science.

:::

## æ•°æ®å’Œè°ä¹‹é“ï¼ˆA TAO of Data Harmonizationï¼‰

:::: {.columns}

::: {.column width="60%"}

*ç›®æ ‡*

1. ä½¿ç”¨å°½å¯èƒ½å¤šçš„æ•°æ®
1. æœ€å¤§é™åº¦æ¶ˆé™¤äººå·¥é”™è¯¯
1. æ•°æ®ç»“æœ[ç¨³å¥æ€§]{.red}å’Œ[å¯å¤åˆ¶æ€§]{.red}

::: {.notes}

1. To incorporate as much available data as possible to provide a base for comparable data and increase generality of the inferences;
1. To reduce the manual entry errors to improve the accuracy of the harmonized data and analytic data; and 
1. To improve the reproducibility of data wrangling process for the sake of transparency.

:::


::: {.fragment}

*æ–¹æ³•*

1. [T]{.red}eam-based concept construct and data selection;
1. Data entry [a]{.red}utomation and fully diagnoses; 
1. "Second-order" [o]{.red}pening.

:::

:::

::: {.column .fragment width="40%"}

*æ¼”ç¤ºæ¡ˆä¾‹*

::: {.r-vstack}

![*ç¡¬æ•°æ®*: SWIID](https://drhuyue.site:10002/sammo3182/figure/wrangle_swiid.png){fig-align="center"}

![*è½¯æ•°æ®*: DCPO](https://drhuyue.site:10002/sammo3182/figure/wrangle_dcpo.png){fig-align="center"}

:::

::: {.notes}

- SWIID is a long-running project that seeks to provide harmonized income inequality statistics for the broadest possible coverage of countries and years
- DCPO is both a method and a database, to address the lack of cross-national and longitudinal data on many topics

:::

:::

::::


## Step 1: Team-Based Construct Building and Data Selection

:::: {.columns}

::: {.column width="50%"}

*ç›®æ ‡é—®é¢˜*

- â€œæ‰‹æ®‹â€ä¹‹ç°å®
    - å³ä½¿ç»è¿‡äºŒæ¬¡æŸ¥éªŒï¼Œæ•°æ®æ•´åˆé”™è¯¯ç‡ä»è¶…è¿‡1% [@BarchardPace2011]
    - é‡‘èå’Œæ°‘èˆªç•Œæƒ¨ç—›æ•™è®­[@HaegemansEtAl2019]

:::

::: {.column .fragment width="50%"}

*è§£æ³•*: Team work

- æ¦‚å¿µæ„å»º
- æ•°æ®é€‰æ‹©
- åˆç†æ€§æ ¡éªŒ

![Source: @BarchardPace2011 [fig. 2]](https://drhuyue.site:10002/sammo3182/figure/wrangle_doubleEntry.png){.fragment fig-align="center" height=300}

:::

::::

::: {.notes}

- SWIID: 
    - Told RAs that the goal of the research, a list of sources mainly from national statistic bureaus for them to start, but we also told them that update statistics for some countries may come from academic papers, published documents, and other sources, and they are free to add them in while *making sure a valid link* of the new sources are also recorded.
    - how the data would use later is also important, as they could have a better sense of what data are analyticable and a forward perspective of how many situations would the later entry part need to take care. In the SWIID project, we told the RAs that the inequality statistics be recorded in four formats: Gini index in disposable (post-tax, post-transfer) income, Gini in market (pre-tax, pre-transfer) income, absolute redistribution (market-income inequality minus net-income inequality), or relative redistribution (market-income inequality minus net-income inequality, divided by market-income inequality).
    - Cross-check: with new RAs
- DCPO: clearly defining and agreeing upon the latent construct among team members 
    - Done by researchers not RAs
    - Each team member is then assigned survey datasets from specific geographic regions and tasked with identifying potentially relevant items and potential dimensions based on both general theoretical guidance and region-specific knowledge. 
    - Before data selection begins, team members undergo hands-on training on how the method work and what type of data and detail they need to collect, such as data format and weighting types, which provide a valuable help of later build the automative data preparation software. 
    - the dural-entry section comes in: each team member reviews and re-codes the survey data originally handled by another member.
    - Disputed cases are flagged for group discussion.

:::

## Step 2: Automation & Diagnosis

:::: {.columns}

::: {.column width="50%"}

*ç›®æ ‡é—®é¢˜*: æ‰‹åŠ¨è¾“å…¥é”™è¯¯å’Œç»“æœâ€œé è°±æ€§â€

:::

::: {.column width="50%"}

*è§£æ³•*: å°½å¯èƒ½åœ°è‡ªåŠ¨åŒ–

- Programming + API 

:::

::::

![](https://drhuyue.site:10002/sammo3182/figure/wrangle_api.png){fig-align="center" height=500}

::: {.notes}

- `DCPOTools`, `countrycode`, `tabulapdf`

:::

## DCPOæ“ä½œè‡ªåŠ¨åŒ–

1. æ”¶é›†surveyæ•°æ®ï¼Œæ˜ç¡®ä¸æ„Ÿå…´è¶£çš„å˜é‡ç›¸å…³çš„æŒ‡æ ‡é—®é¢˜ï¼ˆæ‰‹åŠ¨ï¼‰
1. é€šè¿‡`DCPOtools`å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆåŠè‡ªåŠ¨ï¼‰
1. é€šè¿‡`DCPO`è¿›è¡Œæ•°æ®åˆ†æï¼ˆè‡ªåŠ¨ï¼‰
1. é€šè¿‡`shinystan`è¯Šæ–­convergenceï¼ˆè‡ªåŠ¨ï¼‰

::: {.callout-tip}

## è¯Šæ–­ä»€ä¹ˆå’Œå¦‚ä½•ç†è§£

- Bayesian inferenceæ–¹æ³•ï¼šMarkov Chain Monte Carlo (MCMC)
- æ•°æ®æ‹Ÿåˆâ€œåº•çº¿â€ï¼šConvergence
- å½“Chainçš„posterioråœç•™åœ¨ä¸€ä¸ª[ç›¸å¯¹ç¨³å®š]{.red}çš„åŒºåŸŸå†…([ergodic]{.red} chain)
    - $\lim_{n\to \infty}p^n(\theta_i, \theta_j) = \pi(\theta_j), \forall \theta_i, \theta_j.$

:::


## Step 3: "Second-Order" Opening

*ç›®æ ‡é—®é¢˜*: ç¤¾ä¼šç§‘å­¦ç ”ç©¶ä»ä¸å¤Ÿé€æ˜

[*è§£æ³•*: Second-order opening, ä¸æ­¢æ­¥äºåˆ†æï¼Œè¿˜æœ‰DGP]{.fragment}

::: {.r-hstack .fragment}

![Quarto](https://drhuyue.site:10002/sammo3182/figure/wrangle_quarto.svg){fig-align="center" height=400}

![Github](https://drhuyue.site:10002/sammo3182/figure/wrangle_github.png){fig-align="center" height=400}

![OSF](https://drhuyue.site:10002/sammo3182/figure/wrangle_osf.png){fig-align="center" height=400}

:::

::: {.notes}

If researchers applied our suggestions of team-based construct building, systematic data selection, and automated data entry, the second-order opening becomes both feasible and efficient.
Along with a clearly conceptualized theoretical framework, researchers can simply share their programming scripts for data downloading, formatting, and wrangling, ensuring that the full pipeline is documented and reproducible.

With developed scientific and technical publishing system, such as Quarto or R markdown, and version control platforms (e.g., Github) and open collaboration platforms (e.g., Open Science Framework, OSF), researchers can integrate the entire workflowâ€”from raw data collection to final analysisâ€”within a single, publicly trackable archive.
We reached at this step for all the DCPO projects so far. 

:::

## æœªå°½ä¹‹äº‹ä¸š

::: {.r-hstack}

![Source: Hu et al. 2025a, Fig 1](https://drhuyue.site:10002/sammo3182/figure/wrangle_diagram.png){fig-align="center" height=600 width=500}

![Source: [Kuocheng Liao](https://hbr.org/2018/07/collaborative-intelligence-humans-and-ai-are-joining-forces) ](https://drhuyue.site:10002/sammo3182/figure/wrangle_human.png){fig-align="center" height=600}

:::

# æ½œå˜é‡åˆ†æçš„ç»´åº¦é€‰æ‹©

## å¦‚ä½•ç¡®å®šçœ‹ä¸è§çš„ç»´åº¦

A.k.a., ä½ æ€ä¹ˆçŸ¥é“åªæœ‰[ä¸€ä¸ª]{.red}æ½œåœ¨å˜é‡ï¼Ÿ

- å¤§éƒ¨åˆ†IRTæ¨¡å‹å‡å®šåªæœ‰ä¸€ä¸ªæ½œåœ¨å˜é‡

![ä½†ç¤¾ä¼šç§‘å­¦ä¸­å¾€å¾€ä¸æ˜¯å¦‚æ­¤](https://drhuyue.site:10002/sammo3182/figure/lv_rp.png){.fragment fig-align="center" height=400}

## è¿¹è±¡ [@HuEtAl2025b]

::: {.r-stack}

![](https://drhuyue.site:10002/sammo3182/figure/lv_democracyDimension.png){fig-align="center" height=600}

![](https://drhuyue.site:10002/sammo3182/figure/lv_democracyRofLaw.png){.fragment fig-align="center" height=600}

:::

## ç†è®ºæ ‡å‡†

::: {.callout-important}

## Measurement Invariance [@PutnickBornstein2016]

- åº¦é‡æ’å®šæ€§ (Metric invariance): æ½œåœ¨å˜é‡çš„â€œä¸€å•ä½å˜åŒ–â€åœ¨æ‰€æœ‰ç¾¤ä½“ä¸­éƒ½ä»£è¡¨ç›¸åŒçš„å«ä¹‰
    - æœ‰åº¦é‡æ’å®šæ€§ï¼Œå³å¯æ¯”è¾ƒå…³ç³»ç³»æ•°ï¼ˆå¦‚ç›¸å…³æ€§ã€å›å½’ç³»æ•°ç­‰ï¼‰ï¼Œä½†[ä¸èƒ½ç›´æ¥æ¯”è¾ƒå¹³å‡å€¼]{.red}
- æˆªè·ä¸å˜æ€§ (Scalar invariance): å½“ä¸¤ä¸ªæ¯”è¾ƒå¯¹è±¡çš„çœŸå®æ½œåœ¨æ°´å¹³ç›¸åŒï¼Œä»–ä»¬åœ¨ä¸åŒç¾¤ä½“ä¸­ç»™å‡ºçš„è§‚æµ‹å€¼å¹³å‡å€¼ä¹Ÿåº”ç›¸åŒã€‚
    - é¡»åœ¨åº¦é‡æ’å®šæ€§åŸºç¡€ä¸Šå®ç°

:::

![ä¸€ä¸ªğŸŒ°](https://drhuyue.site:10002/sammo3182/figure/process_interview.jpg){.fragment fig-align="center" height=350}

::: {.notes}

1. **åº¦é‡ä¸å˜æ€§ (Metric invariance)**

* å®šä¹‰ï¼šä¸åŒç¾¤ä½“ä¸­ï¼Œæ½œåœ¨å˜é‡ä¸æµ‹é‡æŒ‡æ ‡ä¹‹é—´çš„å…³ç³»å¼ºåº¦ï¼ˆå³å› å­è½½è·ï¼‰ç›¸åŒã€‚
* å«ä¹‰ï¼šæ½œåœ¨å˜é‡çš„â€œä¸€å•ä½å˜åŒ–â€åœ¨æ‰€æœ‰ç¾¤ä½“ä¸­éƒ½ä»£è¡¨ç›¸åŒçš„å«ä¹‰ã€‚
* ä¸¾ä¾‹ï¼šå¦‚æœâ€œå¹¸ç¦æ„Ÿâ€å¢åŠ  1 å•ä½ï¼Œåœ¨ç”²å›½å’Œä¹™å›½ï¼Œäººä»¬å¯¹â€œæˆ‘ç»å¸¸å¾®ç¬‘å’Œå¤§ç¬‘â€è¿™é“é¢˜çš„å¹³å‡å›ç­”éƒ½ä¼šå¢åŠ åŒæ ·çš„å¹…åº¦ã€‚

ğŸ‘‰ æœ‰åº¦é‡ä¸å˜æ€§æ—¶ï¼Œå¯ä»¥æ¯”è¾ƒä¸åŒç¾¤ä½“é—´çš„**ç›¸å…³æ€§æˆ–å›å½’ç³»æ•°**ï¼Œä½†ä¸èƒ½ç›´æ¥æ¯”è¾ƒå¹¸ç¦æ„Ÿçš„å¹³å‡æ°´å¹³ã€‚

2. **æˆªè·ä¸å˜æ€§ (Scalar invariance)**

* å®šä¹‰ï¼šåœ¨åº¦é‡ä¸å˜æ€§çš„åŸºç¡€ä¸Šï¼Œä¸åŒç¾¤ä½“çš„æµ‹é‡æŒ‡æ ‡çš„æˆªè·ï¼ˆinterceptsï¼‰ä¹Ÿç›¸åŒã€‚
* å«ä¹‰ï¼šå½“ä¸¤ä¸ªäººçš„çœŸå®æ½œåœ¨æ°´å¹³ç›¸åŒï¼Œä»–ä»¬åœ¨ä¸åŒç¾¤ä½“ä¸­ç»™å‡ºçš„è§‚æµ‹åˆ†æ•°ï¼ˆå¦‚é—®å·å›ç­”ï¼‰å¹³å‡å€¼ä¹Ÿåº”ç›¸åŒã€‚
* ä¸¾ä¾‹ï¼šç”²å›½å’Œä¹™å›½ä¸¤ä¸ªåŒæ ·å¹¸ç¦çš„äººï¼Œåœ¨é—®å·ä¸Šéƒ½ä¼šç»™å‡ºç›¸ä¼¼çš„å›ç­”ï¼ˆä¸ä¼šå› ä¸ºæ–‡åŒ–å·®å¼‚ï¼Œä¸€ä¸ªç­”â€œåŒæ„â€è€Œå¦ä¸€ä¸ªç­”â€œä¸­ç«‹â€ï¼‰ã€‚

ğŸ‘‰ æœ‰æˆªè·ä¸å˜æ€§æ—¶ï¼Œç ”ç©¶è€…å°±å¯ä»¥æ¯”è¾ƒç¾¤ä½“é—´çš„**æ½œåœ¨å‡å€¼å·®å¼‚**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åˆç†åœ°è¯´â€œç”²å›½æ¯”ä¹™å›½æ›´å¹¸ç¦â€ã€‚

æ¢å¥è¯è¯´ï¼š

* **åº¦é‡ä¸å˜æ€§** â†’ ä¸åŒç¾¤ä½“ç”¨çš„æ˜¯åŒæ ·çš„â€œåˆ»åº¦å•ä½â€ã€‚
* **æˆªè·ä¸å˜æ€§** â†’ ä¸ä»…åˆ»åº¦ç›¸åŒï¼Œè€Œä¸”é›¶ç‚¹åŸºå‡†ä¹Ÿä¸€è‡´ã€‚

:::

## ä¸€ç§ï¼ˆé—´æ¥ï¼‰éªŒè¯æ–¹æ³•ï¼šCFM

:::: {.columns}

::: {.column width="50%"}

**EFA: æ•°æ®æŒ‡å‘**

1. å®è¯è§‚å¯Ÿï¼ˆå½’çº³ï¼‰
    - *æ— æ³•ç»Ÿè®¡æ¨æ–­*
1. æœªçŸ¥ç»´åº¦
    + æ¯ä¸ªç»´åº¦éƒ½äº§ç”Ÿå½±å“
1. å¤šé‡æŒ‡æ ‡
    + Loadingå¤§å°ä¹‹åˆ†
1. æ— è§†æµ‹é‡åå·®å…³è”
1. Underidentified

:::

::: {.column .fragment width="50%"}

**CFA: ç†è®ºæŒ‡å‘**

1. ç†è®ºå®šä¹‰ï¼ˆæ¼”ç»ï¼‰
    - [*ä¸“ä¸ºç»Ÿè®¡æ¨æ–­*]{.red}
1. æ˜ç¡®ç»´åº¦
    + ç»´åº¦-æŒ‡æ ‡å…³ç³»æ˜ç¡®
1. å•ä¸€æŒ‡æ ‡
    + Loading[æœ‰æ— ]{.red}ä¹‹åˆ†
1. å…è®¸æµ‹é‡è¯¯å·®ç›¸å…³
1. å¿…é¡»identifiable

:::

::::

## CFAæŒ‡æ ‡é€‰æ‹©

:::: {.columns}

::: {.column width="50%"}

1. ä¸¥æ ¼ä¾æ®ç†è®ºï¼š~~åŸå› ~~æ•ˆæœæŒ‡æ ‡
1. æ¯ç»´åº¦ä¸€æŒ‡æ ‡ï¼Œ[è‰ºæœ¯>æŠ€æœ¯]{.red}

:::{.fragment}

ğŸŒ° äººé™…ä¿¡ä»»: [ç›¸ä¿¡]{.red}ä»–äººä¸ä¼š[ä¼¤å®³è‡ªå·±]{.red}æˆ–[è¿èƒŒçº¦å®š]{.red}.

```{r}
#| label: cfa
#| eval: false

DiagrammeR::grViz(
  "digraph {

graph[layout = dot]

node[shape = rectangle, style = filled, fillcolor = Linen]

s [label = 'Interpersonal Trust', shape = 'ellipse']
d [label = 'General Trust']
j [label = 'Altruism']
i [label = 'Credibility']

# edge definitions with the node IDs
s -> {d, j, i}
}"
)
```

![](https://drhuyue.site:10002/sammo3182/figure/lv_interTrust.png){fig-align="center" height=300}

:::

:::

::: {.column .fragment .nonincremental width="50%"}

æŒ‡æ ‡ï¼š

1. æ€»ä½“è€Œè¨€ï¼Œæ‚¨æ˜¯è®¤åŒå¤šæ•°äººæ˜¯å€¼å¾—ä¿¡ä»»çš„ï¼Œè¿˜æ˜¯é˜²äººä¹‹å¿ƒä¸å¯æ— ï¼Ÿ
1. æ‚¨è®¤ä¸ºå¤šæ•°æ—¶å€™äººä»¬æ˜¯ä¹äºåŠ©äººçš„è¿˜æ˜¯è‡ªç§è‡ªåˆ©çš„ï¼Ÿ
1. å¦‚æœæœ‰æœºä¼šï¼Œæ‚¨è®¤ä¸ºåˆ«äººæ˜¯ä¼šå æ‚¨ä¾¿å®œï¼Œè¿˜æ˜¯è¯´ä¼šæªå®ˆçº¦å®šã€å…¬å¹³è¡Œäº‹ï¼Ÿ

:::

::::



## å¦ä¸€ä¸ªğŸŒ°ï¼šè¿åŠ¨å‘˜è¯„ä»·

![](https://drhuyue.site:10002/sammo3182/figure/lv_multitrait.png){fig-align="center" height=600}

:::{.notes}

è£åˆ¤å¯¹æ»‘é›ªè¿åŠ¨å‘˜çš„è¯„åˆ¤

å•ä¾§: factor complexity = 1 ï¼ˆä¸€ä¸ªå˜é‡åªè´¡çŒ®ä¸€ä¸ªlatentï¼‰  
åŒä¾§: factor complexity > 1

:::

## å®šä¹‰å…¬å¼ {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

:::{.callout-important}

$$
\begin{align}
X^* =& \Phi\Lambda' + \epsilon; \\
X =& \Lambda X_\xi + \epsilon,
\end{align}
$$

:::{style="text-align:center"}

**X**ï¼š æŒ‡æ ‡å‘é‡  
**&xi;**ï¼šæ½œåœ¨å˜é‡  
**&Lambda;<sub>X</sub>**: X = f(&xi;)ç³»æ•°(a.k.a., loading, path)  
**&epsilon;**ï¼šåè¯¯å‘é‡  

**&Phi;**: æ½œåœ¨å˜é‡çš„åæ–¹å·®çŸ©é˜µ  
**&Theta;<sub>&epsilon;</sub>**: åè¯¯çš„åæ–¹å·®çŸ©é˜µ

:::

:::


:::{.notes}

**&xi;**: ksi  
**&delta;**: delta  
**&Phi;**: phi  
**&Theta;<sub>&sigma;</sub>**: theta  

åœ¨EFAä¸­æ½œåœ¨å˜é‡åœ¨ç­‰å·å·¦è¾¹ï¼Œè§‚æµ‹å˜é‡åœ¨å³è¾¹

:::

:::

::: {.column .fragment width="60%"}

![](https://drhuyue.site:10002/sammo3182/figure/lv_partMultitrait.png){ fig-align="center" height=600}

:::

::::


## ä¼°ç®— {auto-animate=true}

:::: {.columns}

::: {.column width="40%"}

![](https://drhuyue.site:10002/sammo3182/figure/lv_partMultitrait.png){ fig-align="center" height=300}

[æ½œå˜é‡çŸ©é˜µ]{.navy}

$$
\Phi = \begin{bmatrix}
\phi_{11} & & \\
0 & \phi_{22} & \\
0 & \phi_{23} & \phi_{33}
\end{bmatrix}
$$

:::{.notes}

&phi;23$: classical å’Œshowy è£åˆ¤çš„ç›¸å…³æ€§

:::

:::

::: {.column width="60%"}

[æµ‹é‡çŸ©é˜µ]{.red}

$$
\begin{bmatrix}
x_1\\
x_2\\
x_3\\
x_4\\
x_5
\end{bmatrix} = 
\begin{bmatrix}
1 & 1 & 0\\
\lambda_{21} & 1 & 0\\
\lambda_{31} & 1 & 0\\
\lambda_{41} & 0 & 1\\
\lambda_{51} & 0 & 1
\end{bmatrix} \begin{bmatrix}\xi_1\\
\xi_2\\
\xi_3
\end{bmatrix} + \begin{bmatrix}\epsilon_1\\
\epsilon_2\\
\epsilon_3\\
\epsilon_4\\
\epsilon_5
\end{bmatrix}
$$

[åè¯¯çŸ©é˜µ]{.green}

diag **&Theta;<sub>&sigma;</sub>** = diag[var(&epsilon;<sub>1</sub>) var(&epsilon;<sub>2</sub>)...var(&epsilon;<sub>5</sub>)]

:::

::::




## Identification

a.k.a., æœ€å¤šèƒ½è¿å¤šå°‘çº¿ï¼Ÿ

:::: {.columns}

::: {.column width="50%"}

Identified: å½“**&Lambda;ã€&Phi;ã€&Theta;**å­˜åœ¨å”¯ä¸€è§£

**&Lambda;**: $X = f(\xi)$ç³»æ•° (a.k.a., loading)ï¼›    
**&Phi;**: æ½œåœ¨å˜é‡çš„åæ–¹å·®çŸ©é˜µï¼›   
**&Theta;**: åè¯¯çš„åæ–¹å·®çŸ©é˜µã€‚


:::{.fragment}

**t rule**:

t < q(q + 1)/2

t: ä¸å¯è§   
qï¼šå¯è§

:::


:::{.notes}

Another way to calculate df.

:::

:::

::: {.column width="50%"}

ä¸ºä¿è¯identifableè¿›è¡Œçš„é™åˆ¶

1. Scaling
    + &lambda;<sub>11</sub> = 1;
    + å°†æ½œåœ¨å˜é‡æ–¹å·®è®¾ä¸º1(Standardized metric)
2. å‚æ•°è°ƒæ•´
    + ç‰¹å®šå› å­loadingè®¾ä¸º0ï¼›
    + åè¯¯çš„åæ–¹å·®è®¾ä¸º0ï¼›
    + åè¯¯çš„æ–¹å·®è®¾ä¸º0.

:::

::::


## æ±‚è§£

$$\Sigma(\theta) = \Lambda_X\Phi\Lambda_X' + \Theta_\epsilon,$$
**&Sigma;**: æ‰€æœ‰å¯è§æŒ‡æ ‡å¾—åæ–¹å·®çŸ©é˜µ

:::{.notes}

å¯»æ‰¾æœ€ä¼˜**&Sigma;**

:::

:::: {.columns}

::: {.column .fragment .nonincremental width="50%"}

å…¨ä¿¡æ¯ä¼°è®¡ (Maximum likelihood)

- Generalized Least Squares  
- Unweighted Least Squares

:::

::: {.column .fragment .nonincremental width="50%"}

æœ‰é™ä¿¡æ¯ä¼°è®¡

- Two Stage Least Squares

:::

::::


## å¸¸è§é—®é¢˜

:::: {.columns}

::: {.column width="30%"}

`é”™è¯¯ï¼šå¾…åˆ†æçš„çŸ©é˜µä¸æ˜¯æ­£å®šçš„`

+ æ•°æ®æˆ–åæ–¹å·®çŸ©é˜µä¸­å½•å…¥é”™è¯¯
+ ç¼ºå¤±æ•°æ®
+ **å®Œå…¨å…±çº¿æ€§**
+ å¼‚å¸¸å€¼

:::

::: {.column width="35%"}

`é”™è¯¯ï¼šä¸æ°å½“çš„è§£`

+ å½•å…¥é”™è¯¯
+ æ€»ä½“å€¼æ¥è¿‘å˜é‡è¾¹ç•Œï¼ŒåŠ ä¹‹æŠ½æ ·æ³¢åŠ¨
+ æ¨¡å‹é”™è¯¯
+ å› ç´ æŒ‡æ ‡è§‚æµ‹é‡è¿‡å°ï¼ˆ<150å·¦å³ï¼‰ä¸”**åªæœ‰2ä¸ªæŒ‡æ ‡**
+ â€œUnluckyâ€æ ·æœ¬
+ å¼‚å¸¸å€¼

:::

::: {.column width="35%"}

`é”™è¯¯ï¼šæœªæ”¶æ•›`

+ å½•å…¥é”™è¯¯
+ Unidentifiable
+ æ¨¡å‹ä¸ä½³
+ èµ·å§‹å€¼ä¸ä½³
+ å°æ ·æœ¬ï¼ˆN<100ï¼‰
+ æ¯ä¸ªå› ç´ åªæœ‰2æŒ‡æ ‡
+ å¼‚å¸¸å€¼
+ è§‚æµ‹å˜é‡**é‡çº²æå¤§å·®å¼‚**

:::

::::

:::{.notes}

`Error: Matrix to be analyzed not positive definite`

+ Typo in data file or covariance matrix
+ Pairwise deletion of missing data
+ Perfect collinearity
+ Outliers/influential cases


`Error: Improper solutions`

+ Typo in program
+ Population value near the borderline combined with sampling fluctuation
+ Specification error
+ Small samples (<150 or so) combined with 2 indicators per factor
+ â€œunluckyâ€ sample
+ Outliers/influential cases


`Error: Nonconvergence`

+ Typo in program, data file, or covariance matrix
+ Underidentified model
+ Poor model specification
+ Bad starting values
+ Small samples (N<100)
+ Only 2 indicators per factor
+ Outliers/influential cases
+ Observed variables in very different scale

:::

## è¯Šæ–­æ–¹æ³•

*Overall: &chi;<sup>2</sup>*ï¼Œç»“æœ[æ˜¾è‘—]{.red}^[ç„¶è€Œï¼Œå½“Nè¶³å¤Ÿå¤§æ—¶&chi;<sup>2</sup>é€šå¸¸æ˜¾è‘—ã€‚]åˆ™è¯´æ˜æ•´ä½“æ¨¡å‹å¯èƒ½[æœ‰é—®é¢˜]{.red}ã€‚

:::{.notes}

1. Because models are almost always incorrect, any otherwise reasonably fitting model can be rejected when sample size is sufficient
1. Also a poor fitting model could be accepted if there is insufficient power to detect misspecification.

:::


:::{.fragment .nonincremental}

*Incremental Fit Indices*ï¼šå°†æ¨¡å‹ä¸åŸºçº¿æ¨¡å‹æ¯”è¾ƒ

1. Tucker-Lewis Index (TLI, &rho;<sub>2</sub>, Non-Normed Fit Index)
1. Comparative Fit Index (CFI)

:::

:::{.notes}

åŸºçº¿æ¨¡å‹ï¼šåªä¿ç•™å¯è§å˜é‡çš„æ–¹å·®å’Œåæ–¹å·®

1 ç†æƒ³æƒ…å†µ    
<.95 ä¸å¯æ¥å—

CFIå¯ä»¥>1, è¿™ç§æƒ…å†µè§†ä¸º1

:::


:::{.fragment .nonincremental}

*Absolute Fit Indices*

1. Root Mean Square Error of Approximation (RMSEA)
1. Standardized Root Mean Square Residual (SRMR)

:::

:::{.notes}

+ 0 ç†æƒ³æƒ…å†µ
+ &le; 0.05 ä¸é”™
+ 0.05 ~ 0.08 å·®å¼ºäººæ„
+ &ge; 0.1 ä¸å¯æ¥å—

:::



## ğŸŒ° Holzinger & Swineford 1939


å¯¹åˆä¸­ç”Ÿç²¾ç¥çŠ¶å†µçš„è°ƒæŸ¥ï¼š è§†è§‰å› ç´ ï¼ˆx<sub>1~3</sub>ï¼‰ + é˜…è¯»å› ç´ ï¼ˆx<sub>4~6</sub>ï¼‰+ ï¼ˆè¡¨è¾¾å› ç´ ï¼šx<sub>7~9</sub>ï¼‰

```{r}
#| label: diagram-cfa
#| fig-align: center

HS.model <- ' visual  =~ x1 + x2 + x3
            textual =~ x4 + x5 + x6
            speed   =~ x7 + x8 + x9 '
fit <- cfa(HS.model, data = HolzingerSwineford1939)

semPaths(
  fit,
  layout = "tree",
  curve = 1,
  rotation = 4,
  nCharNodes = 0,
  mar = c(3, 20, 3, 20),
  border.width = 1.0,
  esize = 1.0,
  edge.color = "black",
  label.scale = FALSE,
  label.cex = 1.0,
  residuals = FALSE,
  fixedStyle = 1,
  freeStyle = 1,
  curvePivot = FALSE,
  sizeMan = 7,
  sizeLat = 10
)
```

## ä¼°æµ‹ç»“æœä¸è¯Šæ–­

```{r}
#| label: results-hsModel

fit <- cfa(HS.model, data = HolzingerSwineford1939)

summary(fit, fit.measures = TRUE)
```

## ä½¿ç”¨CFAç¡®è®¤/éªŒè¯ç»´åº¦ [@Joreskog1971]

```{r}
#| label: mgcfa

library(DiagrammeR)

grViz(
  "
digraph cfa_vs_mgcfa {

  graph [rankdir = TB, bgcolor = white, nodesep = 0.35, ranksep = 0.55]

  # ----- default node/edge styles -----
  node [shape = rounded, style = filled, fontname = Helvetica, color = black, width = 3.7, height = 0.6]
  edge [color = black, arrowsize = 0.8]

  # ===== LEFT COLUMN: Regular CFA =====
  subgraph cluster_cfa {
    label = 'Regular CFA\\n(Within-group validation)';
    labelloc = t; fontsize = 16; fontcolor = '#1b5e20';
    color = '#c8e6c9'; penwidth = 1;

    cfa1 [label='One group of data', fillcolor = '#a5d6a7'];
    cfa2 [label='Multiple latent variables\n(factors) allowed', fillcolor = '#a5d6a7'];
    cfa3 [label='Tests if model fits\nwithin this single group', fillcolor = '#a5d6a7'];

    {rank = same; }  # let Graphviz place rows vertically

    # vertical flow (left)
    cfa1 -> cfa2 -> cfa3;
  }

  # ===== RIGHT COLUMN: MGCFA =====
  subgraph cluster_mgcfa {
    label = 'Multiple-Group CFA (MGCFA)\\n(Cross-group comparability)';
    labelloc = t; fontsize = 16; fontcolor = '#7f0000';
    color = '#ffcdd2'; penwidth = 1;

    mg1 [label='Two or more groups of data', fillcolor = '#ef9a9a'];
    mg2 [label='Same factor model tested\nacross groups', fillcolor = '#ef9a9a'];
    mg3 [label='Sequential tests of invariance\n(configural â†’ metric â†’ scalar â†’ strict)', fillcolor = '#ef9a9a', width=4.6];
    mg4 [label='Allows valid group comparisons\n(correlations, regressions, means)', fillcolor = '#ef9a9a'];

    # vertical flow (right)
    mg1 -> mg2 -> mg3 -> mg4;
  }

  # ----- layout hints so the two columns align -----
  { rank = same; cfa1 mg1 }
  { rank = same; cfa2 mg2 }
  { rank = same; cfa3 mg3 }
}
"
)

```

::: {.fragment .large style="text-align:center; margin-top: 0.5em"}

Theory matters!

:::

::: {.notes}

Using MGCFA to confirm dimensions

:::


## ç¡®è®¤ç»´åº¦ä¹‹å [@BerwickCaughey2025]

::::{.overlay-container}

:::{.overlay-image}

![](https://drhuyue.site:10002/sammo3182/figure/lv_modgirt.png){fig-align="center" height=600}

:::

:::{.overlay-text-over .fragment}

[Multidimensional]{.red}, multilevel IRT

- **Strengths**
    - Flexible: Single-country or cross-national datasets
    - Extensible: Overdispersion, differential item functioning, and predictors.

- **Considerations**
    - Computationally intensive (Bayesian estimation).
    - Needs bridging items for comparability across groups/time.

:::

::::


## æ€»ç»“

:::: {.columns}

::: {.column width="50%"}

- å¹³å‡å€¼å±‚æ¬¡ï¼ˆMRPï¼‰
    - è®¡ç®—å…·æœ‰æ€»ä½“æ„ä¹‰çš„ç»„åˆ«å¹³å‡å€¼
    - éœ€è¦ç»„åˆ«åˆ†å¸ƒ
    - å±€é™
        - é—®é¢˜å·®å¼‚
        - ç­”é¢˜å·®å¼‚
- ç¾¤ç»„IRTï¼ˆDGIRTï¼Œ[DCPO]{.red}ï¼‰
    - è®¡ç®—ç¾¤ç»„å±‚çº§å¯æ¯”åº¦é‡
    - æ“ä½œ
        - [T]{.red}eam-work collection
        - [A]{.red}utomation everything
        - [O]{.red}pening

:::

::: {.column width="50%"}

- åˆ†æç»´åº¦åˆ¤å®š
    + éªŒè¯æ€§å› å­åˆ†æï¼šæ£€éªŒæ½œåœ¨å˜é‡å¯¹äºè§‚å¯ŸæŒ‡æ ‡æ˜¯å¦æœ‰å½±å“
        + CFAè¯Šæ–­ï¼š&chi;<sup>2</sup>, TLI/CFIï¼ŒRMSEA/SRMR
    - CFA + IRT
        - MGCFA
        - MODGIRT

:::

::::

# æ¬¢è¿äº¤æµ {background="#43464B"}

:::{style="text-align: right; margin-top: 1em"}  

[`r feather_icons("github")`&nbsp; sammo3182](https://github.com/sammo3182)

[`r feather_icons("mail")`&nbsp; yuehu@tsinghua.edu.cn](mailto:yuehu@tsinghua.edu.cn) 

[`r feather_icons("globe")`&nbsp; https://sammo3182.github.io/](https://sammo3182.github.io/)

![](https://user-images.githubusercontent.com/6463211/232207708-b0e64eee-7fb3-45a4-9779-ec52397f786c.png){height=250}

:::

## å‚è€ƒæ–‡çŒ® {.unnumbered}

::: {#refs}
:::

# é™„å½•ï¼šè´å¶æ–¯ç»Ÿè®¡è¯Šæ–­ {.appendix}


## Convergence ç‰¹å¾


* **å¸¸è¿”**
  * **é½æ¬¡/å°é—­**ï¼šåœ¨ç¬¬ $m$ æ­¥ï¼Œå¦‚æœæ­¤æ­¥çš„è½¬ç§»æ¦‚ç‡ä¸ $m$ æ— å…³ï¼›å¯¹äºçŠ¶æ€ Aã€Bï¼Œ$p(A, B) = 0$
  * **ä¸å¯çº¦**ï¼šå¦‚æœä»ä»»æ„å·²è¾¾ç‚¹/ç‚¹é›†éƒ½å¯ä»¥åˆ°è¾¾å…¶ä»–ä»»æ„å·²è¾¾ç‚¹/ç‚¹é›†ï¼›$p(\theta_i, \theta_j) \neq 0, \ \forall \theta_i, \theta_j$
* **å¹³ç¨³æ€§**ï¼šæ— è‡ªç›¸å…³
* **éå‘¨æœŸæ€§**ï¼šå³ä½¿ç»è¿‡é•¿æ—¶é—´ï¼Œé“¾çš„å–å€¼ä¹Ÿä¸ä¼šå‡ºç°ç›¸åŒçš„å¾ªç¯é‡å¤


:::{.notes}

+ Reccurent
    + Homogeneous/Closed: At step m if the trasition probabilities at this step do not depend on m; for State A, B, p(A, B) = 0
    + Irreducible: If every reached point/point collection can be reached from every other reached point/point collection; p(&theta;<sub>i</sub>, &theta;<sub>j</sub>)&ne; 0, &forall; &theta;<sub>i</sub>, &theta;<sub>j</sub>
+ Stationary: no autocorrelation
+ Aperodic: even with a long time there's no identical cycle of chain values repeating


+ Homogeneity: at step m the transition probability at this step do not depend on
+ Ergodicityï¼šéå†æ€§

:::


## Convergedæ—¶ä»€ä¹ˆæ ·ï¼šä¸€ä¸ªğŸŒ°

:::: {.columns}

::: {.column width="35%"}
>ä¸‹é›ªå•¦å¤©æ™´å•¦   
    ä¸‹é›ªåˆ«å¿˜ç©¿æ£‰è¢„    
    ä¸‹é›ªå•¦å¤©æ™´å•¦    
    å¤©æ™´åˆ«å¿˜æˆ´è‰å¸½    
    å¸¦è‰å¸½~~~  
    ---ã€Šå¿ƒä¸­çš„å¤ªé˜³ã€‹

ä»Šæ™´ï¼Œæ˜80%ä¹Ÿæ™´ï¼›  
ä»Šé›ªï¼Œæ˜60%ä¹Ÿé›ªã€‚

|      |                     | æ˜å¤©                |                     |
|------|---------------------|---------------------|---------------------|
|      |                     | &theta;<sub>1</sub> | &theta;<sub>2</sub> |
| ä»Šå¤© | &theta;<sub>1</sub> | 0.8                 | 0.2                 |
|      | &theta;<sub>2</sub> | 0.6                 | 0.4                 |

:::{.notes}
åˆ˜æ¬¢ï¼šã€Šå¿ƒä¸­çš„å¤ªé˜³ã€‹, ã€Šé›ªåŸã€‹ä¸»é¢˜æ›²ï¼Œ1988å¹´ï¼Œå€ªèä¸»æ¼”

è¯¥æ›²é‡‡ç”¨å†ç°ä¸‰æ®µä½“ç»“æ„å½¢å¼å†™æˆï¼Œå¤–åŠ ä¸€ä¸ªé«˜äº¢ã€æ‚ æ‰¬çš„å°¾å£°ã€‚Aæ®µé‡‡ç”¨æ‚ æ‰¬è‡ªç”±çš„æ•£æ¿èŠ‚å¥ï¼Œå…·æœ‰æ€å¿–æ²‰å¯‚çš„æ„å¢ƒã€‚â€œå¤§å®è¯â€å¼çš„æ­Œè¯ï¼Œé¥±å«ç€å¯¹è‡ªç„¶ã€ç¤¾ä¼šã€äººç”Ÿçš„ä¸è§£ã€ç–‘æƒ‘ä¸è¯˜é—®ã€‚Bæ®µå¼€å§‹è½¬ä¸ºå……æ»¡æ´»åŠ›çš„å¿«æ¿é€Ÿåº¦ï¼Œæ­Œè¯å¼€å§‹ç”±è¯˜é—®è½¬å˜ä¸ºå¯¹äººé—´å¸¸æ€çš„è‚¯å®šã€‚A'æ®µçš„æ—‹å¾‹ä¸å˜ï¼Œåªæ˜¯èŠ‚å¾‹å˜å¾—å¯Œäºæ€¥è¿«æ„Ÿã€åŠ¨åŠ›æ„Ÿï¼Œåœ¨è¿™ç§åŠ¨åŠ›çš„é©±åŠ¨ä¸‹ï¼Œç»§ç»­å¼€å§‹è¯˜é—®ã€‚é«˜äº¢ã€æ‚ æ‰¬çš„å°¾å£°ï¼Œä»¥åå¤å’å”±çš„â€œå•Šå¤ªé˜³â€ç»“æŸï¼Œå¯“æ„ä½œè€…å¯¹äººé—´çœŸç†çš„æ— é™å‘å¾€ä¸åšå®šè¿½æ±‚


example of converged
:::

:::

::: {.column .fragment width="65%"}
èµ·å§‹ç‚¹: [0.5 0.5]

$S_1 = [0.5\; 0.5]\begin{bmatrix}0.8 & 0.2\\ 0.6 & 0.4 \end{bmatrix}=[0.7\; 0.3];$
$S_2 = [0.7\; 0.3]\begin{bmatrix}0.8 & 0.2\\ 0.6 & 0.4 \end{bmatrix}=[0.74\; 0.26];$
$S_3 = [0.74\; 0.26]\begin{bmatrix}0.8 & 0.2\\ 0.6 & 0.4 \end{bmatrix}=[0.748\; 0.252];$
$S_4 = [0.748\; 0.252]\begin{bmatrix}0.8 & 0.2\\ 0.6 & 0.4 \end{bmatrix}=[0.749\; 0.250].$

:::{.fragment}
å†å¾€ä¸‹ç®—ï¼Œä¼šå‘ç°æ¦‚ç‡å˜åŒ–è¶Šæ¥è¶Šå°ï¼Œè¶‹äºç¨³å®šï¼ˆcongvergedï¼‰
:::


:::

::::

## æ£€éªŒConvergence

ç›®å‰æ²¡æœ‰ç»Ÿè®¡åŠæ³•èƒ½å¤Ÿè¯æ˜ä¸€ä¸ªMarkov Chainå·²ç»converged

1. åœ¨ç»™å®šæ—¶é—´å†…ï¼Œæ— æ³•ä¿è¯Markov chainèƒ½å¤Ÿ[è¾¾åˆ°]{.red}ç›®æ ‡åˆ†å¸ƒ;
1. æ— æ³•é¢„å…ˆç¡®å®šä¸€æ¡Chainèƒ½å¤Ÿ[éå†]{.red}ç›®æ ‡åˆ†å¸ƒçš„æ‰€æœ‰åŒºåŸŸ;
1. åªèƒ½è¯Šæ–­ä¸€æ¡Chainæ˜¯å¦[æœª]{.red}converged (è¯Šæ–­å·¥å…·ï¼šGeweke's G, Gelman-Rubin)

:::{.fragment}

å¢åŠ Convergenceå¯èƒ½çš„æ–¹æ³•

1. è¶³å¤Ÿçš„Burn-in rounds (è¯Šæ–­å·¥å…·ï¼šRaftery-Lewis)
1. å°½å¯èƒ½æ’é™¤autocorrelationï¼ˆè¯Šæ–­å·¥å…·ï¼šHeidelberger-Welchï¼‰

:::


## Geweke's G

- æ¯”è¾ƒparametersåœ¨chainæ—©æœŸå’Œæ™šæœŸä¸¤ä¸ª[ä¸é‡å ]{.red}çš„çª—å£å†…çš„å‡å€¼ï¼›
- ä¸»è¦é’ˆå¯¹recurrenceç‰¹å¾

$$G = \frac{\bar{\theta_1}- \bar{\theta_2}}{\sqrt{\frac{s_1}{n_1} + \frac{s_2}{n_2}}}.$$


:::{.notes}

A fancy difference of means

converge åˆ™æ˜¾ç¤ºä¸æ˜¾è‘—å·®å¼‚ï¼Œå¢åŠ burn-in

:::


## Gelman & Rubin 1992

$$\hat{R}= \sqrt{\frac{\hat{var(\theta)}}{W}}$$

1. è·‘å¤šæ¡chainsï¼ˆ5~10ï¼‰ï¼Œæ¯æ¡é•¿2n
1. å¯¹æ¯ä¸€ä¸ªæ„Ÿå…´è¶£çš„parameterè®¡ç®—
    1. Within chain variance(W)
    1. Between chain variance(B)
1. è®¡ç®—æ€»ä½“varianceï¼š var(&theta;) = (1 - 1/n)W + (1/n)B
1. è®¡ç®—Scale reduction (äº¦ç§°shrink factor)


:::{.fragment}

:::{.callout-tip}

- Rè¶‹è¿‘äº1è¡¨ç¤ºchains operating on same distribution
    - < 1.1æˆ–1.2æ˜¯å¯ä»¥æ¥å—çš„

::: 

:::


## Burn-In

- ç»™ä¸è¶³å¤Ÿçš„burning inä»¥åˆ°è¾¾ç›®æ ‡åˆ†å¸ƒ
- â€œç‚¸æ¯›çš„æ¯›æ¯›è™«â€ï¼ˆFuzzy Caterpillarï¼‰

![](https://drhuyue.site:10002/sammo3182/figure/fuzzyCaterpillar.png){fig-align="center" height=450}


## æ£€éªŒBurn-inæ˜¯å¦è¶³å¤Ÿï¼šRaftery & Lewis (1991, 1996)

+ åˆ†åˆ«è¯„ä»·æ¯ä¸€ä¸ªChainçš„æ¯ä¸€ä¸ªå˜é‡
    1. æ ¹æ®Chainé—´çš„ç›¸å…³æ€§ï¼Œå¹¶æ®æ­¤æä¾›ä¸€ä¸ªè¿­ä»£æ•°ï¼ˆiteration numberï¼‰
    1. æ£€éªŒautocorrelation inflation
+ è¾“å‡º
    + Burn-inï¼šä¸€ä½æ•°æˆ–ä¸¤ä½æ•°ä¸ºä½³
    + Totalï¼šå»ºè®®çš„burn-inæ•°ï¼Œæœªè€ƒè™‘cross-chainï¼Œå› æ­¤çœŸæ­£burninè¦ä¹˜ä¸Šchainæ•°
    + Dependence Factor


## Autocorrelation

ç‰¹å¾ï¼š

1. Chainé—´é«˜ç›¸å…³æ€§
1. å•ä¸€parameteré«˜ç›¸å…³æ€§


:::{.notes}

1. Chainé—´é«˜ç›¸å…³æ€§ï¼šSlow convergence
1. å•ä¸€parameterçš„é«˜ç›¸å…³ï¼šIndividual nonconvergence

:::

:::{.r-hstack}

![Autocorrelated](https://drhuyue.site:10002/sammo3182/figure/isAutocorrelation.png){.fragment fig-align="center" height=400}

![Not autocorrelated](https://drhuyue.site:10002/sammo3182/figure/noAutocorrelation.png){.fragment fig-align="center" height=400}

:::



## Heidelberger and Welch

ç”¨äºæ£€éªŒStationarity

1. ç¡®å®šä¸€ä¸ªè¿­ä»£æ•°N, ä»¥åŠå‡†ç¡®æ€§ï¼ˆ&epsilon;ï¼‰å’Œæ˜¾è‘—æ€§æ•°å‡†(&alpha;)
1. è¿è¡Œæ•´ä¸ªchain
1. æ–½ç”¨Cram&eacute;r-von Mises Testï¼ŒNull: Chainæ˜¯stationary
1. å¦‚æ£€éªŒæœªé€šè¿‡åˆ™ä¾æ¬¡ç•¥å»10%ã€20%,ä¹ƒè‡³50%çš„è¿­ä»£ï¼Œå†æ¬¡æ£€æµ‹ï¼›
1. å¦‚ç»“æœè¡¨ç¤ºéƒ¨åˆ†æ•°æ®ä¸æ˜¯stationaryï¼Œåˆ™å¯¹è¯¥éƒ¨åˆ†æ•°æ®è¿›è¡Œhalfwidthæ£€éªŒ
1. å¦‚æœhalfwidth ratio < &epsilon;, åˆ™é€šè¿‡æ£€éªŒ


## Thinning

Thinning å¹¶[ä¸ä¼š]{.red}æé«˜Chainçš„è¿ç®—é€Ÿåº¦ã€å¸®åŠ©convergenceæˆ–å¢å¼ºä¼°æµ‹è´¨é‡

+ æ¯ä¸ªChainè®°å½•å¤šå°‘samples
    + Chainå°†ä»…è®°å½•ç¬¬kä¸ªå€¼ï¼Œè¶Šé«˜ä¸¢å¤±çš„ä¿¡æ¯è¶Šå¤š
    + ké€šå¸¸å–å€¼ï¼š4ï¼Œ5ï¼Œ10
+ ä»…ç”¨äºé™ä½autocorrelation

::: {.callout-tip .fragment}

## ä½•æ—¶è°ƒThin

1. è¿­ä»£ä¸­autocorrelationå¤ªé«˜
1. Chainçš„convergenceå¤ªä½
1. å¹¶è¡Œè¿ç®—
1. æ¨¡å‹ç»´åº¦è¿‡é«˜

:::

# é™„å½•ï¼šç»“æ„æ–¹ç¨‹æ¨¡å‹ {.appendix}

## ä»€ä¹ˆæ˜¯ç»“æ„æ–¹ç¨‹æ¨¡å‹

:::: {.columns}

::: {.column .nonincremental width="50%"}

- Structural equation model (SEM)   
- LISREL (Linear Structural ReLationships) models   
- Covariance structure models   
- Latent variable models    
- Structural equations with latent variables    

![](https://drhuyue.site:10002/sammo3182/figure/lv_sem.png){.fragment fig-align="center" height=200}

:::

::: {.column .fragment .nonincremental width="50%"}

- Confirmative factor analysis  
- Multiple regression  
- Multivariate regression  
- ANOVA  
- General linear model  
- Path analysis  
- Recursive models  
- Dichotomous and ordered probit  
- Seemingly unrelated regressions  
- Simultaneous models  
- Latent growth curve models  
......

:::

::::


## SEM (in terms of CFA)

:::: {.columns}

::: {.column width="50%"}

**ç»“æ„**

+ è§‚å¯Ÿå˜é‡ï¼š X + Y
+ æ¨¡å‹å»ºæ„ï¼š
    1. Latent variable model
    1. Measurement model (CFA)
    1. Relations among the errors 
+ ä¾ç„¶è¦æ±‚identification

**ä¼°è®¡**ï¼šMLE

:::

::: {.column width="50%"}

**è¯Šæ–­**

+ Overallï¼š&chi;<sup>2</sup>
+ Incrementalï¼š
    + TLI & CLI
    + Incremental Fit Index(IFI, &Delta;<sup>2</sup>)
+ Absolute:
    + RMSEA
    + BIC

:::

::::

:::{.fragment}

:::{.callout-tip}

## é™¤äº†CFAï¼ŒSEMè¿˜èƒ½åšä»€ä¹ˆ

*æ•¬è¯·æ³¨æ„*ï¼š[SEMç»“æœä»è¡¨ç°ç›¸å…³å…³ç³»ã€‚]{.red}

å¤„ç†Measurement errorsï¼›å¤„ç†éçº¿æ€§å˜é‡(hint: GSEM)ï¼›çº³å…¥å¤šå±‚æ•ˆåº”ï¼›å¤„ç†ç¼ºå¤±å€¼

:::

:::



## ğŸŒ° Bollen 1989

æ”¿æ²»æ°‘ä¸»ï¼ˆ1960ï¼Œ1965ï¼‰ä¸å·¥ä¸šåŒ–

```{r}
#| label: diagram-sem
#| fig-align: center
#| fig-height: 4
#| fig-keep: last

model <- '
    # measurement model
        ind60 =~ x1 + x2 + x3
        dem60 =~ y1 + y2 + y3 + y4
        dem65 =~ y5 + y6 + y7 + y8
    # regressions
        dem60 ~ ind60
        dem65 ~ ind60 + dem60
    # residual correlations
        y1 ~~ y5
        y2 ~~ y4 + y6
        y3 ~~ y7
        y4 ~~ y8
        y6 ~~ y8
'
fit <- sem(model, data = PoliticalDemocracy)
Graph <- semPaths(
  fit,
  #layout=L,
  layout = "tree2",
  nCharNodes = 0,
  curve = 1,
  rotation = 4,
  #mar=c(3,3,3,3),
  edge.color = "black",
  border.width = 1.0,
  esize = 1.0,
  label.scale = FALSE,
  label.cex = 1.0,
  residuals = FALSE,
  fixedStyle = 1,
  freeStyle = 1,
  curvePivot = FALSE,
  #style="LISREL",
  exoVar = FALSE,
  sizeMan = 7,
  sizeLat = 10,
  DoNotPlot = FALSE
)
L <- matrix(
  c(
    0.4,
    1,
    0.7,
    1,
    1.0,
    1,
    -1.0,
    1,
    -1.0,
    0.71,
    -1.0,
    0.43,
    -1.0,
    0.14,
    -1.0,
    -0.14,
    -1.0,
    -0.43,
    -1.0,
    -0.71,
    -1.0,
    -1,
    0.7,
    0.4,
    0.0,
    0.4,
    0.0,
    -0.4
  ),
  14,
  2,
  byrow = TRUE
)
qgraph(Graph, layout = L, arrowAngle = 0.5)
```

## ç»“æœä¸è¯Šæ–­

```{r}
#| label: results-semModel

fit <- sem(model, data = PoliticalDemocracy)

summary(fit, fit.measures = TRUE)
```

